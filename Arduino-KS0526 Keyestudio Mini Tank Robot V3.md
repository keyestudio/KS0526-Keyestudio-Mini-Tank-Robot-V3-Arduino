# Arduino-KS0526 Keyestudio Mini Tank Robot V3


\*About keyestudio

Keyestudio is a best-selling brand owned by KEYES Corporation. Our
product lines range from controller boards, shields and sensor modules
to smart cars and complete starter kits for Arduino, Raspberry Pi and
BBC micro:bit, which can help customers at any level learn electronics
and programming knowledge. Furthermore, all of our products comply with
international quality standards and are greatly appreciated in a variety
of different markets worldwide.

You can obtain the details and the latest information through the
following web site: <http:/www.keyestudio.com>

\*References and After-sales Service

1.  Download Profile：https:/fs.keyestudio.com/KS0526

2.  If you find any parts missing or encounter any troubles, please feel
    free to contact us:
    **[service@keyestudio.com](http:/m.138.gz.cn/webadmin/~CAmsnCrrNXhTAySKCerrIfWjjZuuWVfI/~/usr/mod_edituser.jsp?;uid=service@keyestudio.com;;clearCache=).**
    We will update projects and products continuously according to your
    sincere advice.
    
    \*Warning

<!-- end list -->

1.  This product contains tiny parts(screws, copper pillars). Therefore,
    keep it out of reach of children under 7 please.

2.  This product consists of conductive parts (control board and
    electronic module). Please operate according to the requirements of
    tutorial. Otherwise, improper operation may cause parts to overheat
    and be damaged. Do not touch or immediately disconnect the circuit
    power.

\*Copyright

The keyestudio trademark and logo are the copyright of KEYES DIY ROBOT
co.,LTD. All products under keyestudio brand can’t be copied, sold and
resold by anyone or any companies without authorization. If you’re
interested in our products, please contact with our sales
representatives:
[**fennie@keyestudio.com**](http:/m.138.gz.cn/webadmin/~CAmsnCrrNXhTAySKCerrIfWjjZuuWVfI/~/usr/mod_edituser.jsp?;uid=fennie@keyestudio.com;;clearCache=)

**Mini Tank Robot V3**

**(Arduino tutorial)**



![](/media/9e6856cf1b771036e3fe440816fa114f.png)

**1. Introduction**

This STEM educational V3.0 tank robot is newly upgraded, adding an
line-tracking and a fire- extinguishing function. It vigorously enhances
the relationship between kids and parents, and sparks children’s
imagination through programming and coding.

In the course of assembly process, you can see its multiple functions
like light following, line tracking, IR and BT remote control, speed
adjustment and so on. Additionally, there are some small parts that can
help you assemble the robot car.

There are basic sensors and modules, such as a flame sensor, a BT
sensor, an obstacle avoidance sensor, an line tracking sensor and an
ultrasonic sensor are included.

The two tutorials for C language and Arduino are also suitable for the
enthusiasts at different ages.

It is really the best choice for you.

**2.Features：**

1.Multiple functions：Confinement, line tracking, fire extinguishing,
light following, IR and BT remote control, speed control and so on

2\. Easy to build: assemble the robot with tiny parts

3\. High tenacity: Aluminum alloy brackets, metal motors, high quality
wheels

4\. High extension: connect many sensors and modules through motor
driver shield and sensor shield.

5\. Multiple controls: IR remote control, App control(iOS and Android
system)

6.  Basic programming：C language code of Arduino IDE.
    
    **3.Parameters：**

Working voltage: 5v

Input voltage: 7-12V

Maximum output current: 2A

Maximum power dissipation: 25W (T=75℃)

Motor speed: 5V 200 rpm/min

Motor drive mode: dual H bridge drive(L298P)

Ultrasonic induction angle: \<15 degrees

Ultrasonic detection distance: 2cm-300cm

Infrared remote control distance: 10 meters (measured)

BT remote control distance: 30 meters (measured)

4.  **Kit List**

<table>
<tbody>
<tr class="odd">
<td>#</td>
<td>Picture</td>
<td>Name</td>
<td>QTY</td>
</tr>
<tr class="even">
<td>1</td>
<td><img src="/media/e7109191dcd9c2d014964b9e2409dc0c.png" style="width:1.76667in;height:1.31667in" /></td>
<td>Wrench</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td><img src="/media/575e374ce74fa69b0b3f43610de08ff6.emf" style="width:1.95972in;height:0.97083in" /></td>
<td>Driving Wheels</td>
<td>2</td>
</tr>
<tr class="even">
<td>3</td>
<td><img src="/media/b73abfc7a734f4862d06712e6310280b.png" style="width:0.68125in;height:0.68264in" /></td>
<td>M4*12mm Hexagon Screws</td>
<td>2</td>
</tr>
<tr class="odd">
<td>4</td>
<td><img src="/media/10d9de74b35431cbaed2e4056ab13b96.png" style="width:1.96458in;height:0.84861in" /></td>
<td>Caterpillar Band</td>
<td>2</td>
</tr>
<tr class="even">
<td>5</td>
<td><img src="/media/bc31aba110b7ad911b46ea77fcb0a7fd.emf" style="width:1.68125in;height:1.02917in" /></td>
<td>Driven Wheel</td>
<td>2</td>
</tr>
<tr class="odd">
<td>6</td>
<td><img src="/media/85982dd58bc2a8bdc8b60968e0b4d7a9.png" style="width:0.69722in;height:1.11667in" /></td>
<td>M4*35mm Hexagon Screws</td>
<td>2</td>
</tr>
<tr class="even">
<td>7</td>
<td><img src="/media/782340778c2838b36784c6920821726a.png" style="width:1.77639in;height:1.66389in" /></td>
<td>Bottom Parts</td>
<td>1</td>
</tr>
<tr class="odd">
<td>8</td>
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.74097in;height:1.25694in" /></td>
<td>Keyestudio V4.0 Development Board</td>
<td>1</td>
</tr>
<tr class="even">
<td>9</td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.75139in;height:1.40694in" /></td>
<td>L298P Motor Driver Shield</td>
<td>1</td>
</tr>
<tr class="odd">
<td>10</td>
<td><img src="/media/725b40552b5104104dc109c5fe6ad7b3.png" style="width:2.13958in;height:0.75139in" /></td>
<td>Keyestudio HM-10 BT-4.0</td>
<td>1</td>
</tr>
<tr class="even">
<td>11</td>
<td><img src="/media/b0906d68835b2659491e53a85567569b.png" style="width:1.73819in;height:0.96597in" /></td>
<td>HC-SR04 Ultrasonic Sensor</td>
<td>1</td>
</tr>
<tr class="odd">
<td>12</td>
<td><img src="/media/4a2be9e7bf76b26b49e10d5d2f3f9bda.png" style="width:1.73681in;height:0.79722in" /></td>
<td>Keyestudio 8*16 LED Panel</td>
<td>1</td>
</tr>
<tr class="even">
<td>13</td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:2.13889in;height:1.70486in" /></td>
<td>Yellow LED Module</td>
<td>1</td>
</tr>
<tr class="odd">
<td>14</td>
<td><img src="/media/ecf808f114234039582880ab4682c4e6.png" style="width:1.71875in;height:1.22569in" /></td>
<td>Flame Sensor</td>
<td>2</td>
</tr>
<tr class="even">
<td>15</td>
<td><img src="/media/ec37bc098e230744bac2fb22b91c503e.png" style="width:1.34375in;height:1.37639in" /></td>
<td>130 Motor Module</td>
<td>1</td>
</tr>
<tr class="odd">
<td>16</td>
<td><img src="/media/694d563668ffd3ff9b453f45963c16f2.png" style="width:1.43889in;height:1.04514in" /></td>
<td>IR Receiver Module</td>
<td>1</td>
</tr>
<tr class="even">
<td>17</td>
<td><img src="/media/9b0193c19a5a7392052adffdfc4e10c2.png" style="width:2.13819in;height:1.78403in" /></td>
<td>Photoresistor</td>
<td>2</td>
</tr>
<tr class="odd">
<td>18</td>
<td><img src="/media/3960ff94f47aca1521f294d929ee2592.png" style="width:1.60625in;height:1.50694in" /></td>
<td><p>Acrylic Board for</p>
<p>8*16 LED Panel</p></td>
<td>1</td>
</tr>
<tr class="even">
<td>19</td>
<td><img src="/media/a8997d05138f338432d7d2e02de72bfd.png" style="width:1.24375in;height:1.53194in" /></td>
<td>Upper Board</td>
<td>1</td>
</tr>
<tr class="odd">
<td>20</td>
<td><img src="/media/9665dfd887f3b761c887fe49e47fbdef.png" style="width:0.80694in;height:0.78542in" /><img src="/media/82e72b8a1e3d2c0eebfa0e96e4b66b83.png" style="width:0.89167in;height:0.91806in" /></td>
<td>Acrylic Board</td>
<td>2</td>
</tr>
<tr class="even">
<td>21</td>
<td><img src="/media/528c200c8566fe1b65715aa7bb21dad3.png" style="width:1.69028in;height:0.82778in" /></td>
<td><p>Keyestudio JMFP-4 17-Key</p>
<p>Remote Control</p>
<p>(Without Batteries)</p></td>
<td>1</td>
</tr>
<tr class="odd">
<td>22</td>
<td><img src="/media/e686213ffb2aa53d9960f9f6d1b600cd.png" style="width:1.69931in;height:1.25069in" /></td>
<td>Keyestudio 9G 180 °Servo</td>
<td>1</td>
</tr>
<tr class="even">
<td>23</td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.80208in;height:0.66667in" /></td>
<td>USB Cable</td>
<td>1</td>
</tr>
<tr class="odd">
<td>24</td>
<td><img src="/media/f353b46e6c2c0597c3268d5aa137fd99.png" style="width:1.65556in;height:0.19514in" /></td>
<td>3.0*40MM Screwdriver</td>
<td>1</td>
</tr>
<tr class="even">
<td>25</td>
<td><img src="/media/a3d702d65769c0e0b682a77a152ca5cc.png" style="width:0.66806in;height:1.75208in" /></td>
<td><p>4P M-F PH2.0mm to 2.54 Dupont Wire</p>
<p>(Green-Blue-Red-Black)</p></td>
<td>1</td>
</tr>
<tr class="odd">
<td>26</td>
<td><img src="/media/2b70dfddb2057cbfc54ecb8666c64aeb.png" style="width:1.65556in;height:0.37222in" /></td>
<td>4P HX-2.54 Dupont Wire (Black-Red-White-Brown)</td>
<td>1</td>
</tr>
<tr class="even">
<td>27</td>
<td><img src="/media/9be46d555e20cfcf32b981ccd90a376f.png" style="width:1.10764in;height:2.08681in" /></td>
<td>5P JST-PH2.0MM Dupont Wire</td>
<td>1</td>
</tr>
<tr class="odd">
<td>28</td>
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.81944in;height:1.58681in" /></td>
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)</td>
<td>1</td>
</tr>
<tr class="even">
<td>29</td>
<td><img src="/media/f493282b2846fe01fe6861126b368480.png" style="width:1.05694in;height:1.60347in" /></td>
<td>3P-3P XH2.54 to PH2.0 Dupont Wire（Yellow-Red-Black)</td>
<td>3</td>
</tr>
<tr class="odd">
<td>30</td>
<td><img src="/media/7856a38f34cdeb19966cd0fb99b55f85.png" style="width:1.03611in;height:1.56944in" /></td>
<td>4P-3P XH2.54 to PH2.0 Dupont Wire（Yellow-Red-Black)</td>
<td>2</td>
</tr>
<tr class="even">
<td>31</td>
<td><img src="/media/26ed32284d40ce65cc336eb952755e64.png" style="width:1.49931in;height:1.59653in" /></td>
<td><p>4P XH2.54 to PH2.0</p>
<p>Dupont Wire（Green-Blue-Red-Black)</p></td>
<td>1</td>
</tr>
<tr class="odd">
<td>32</td>
<td><img src="/media/f304cb590f040f13b4bd93bfc636ddba.png" style="width:0.80139in;height:0.6in" /></td>
<td>M1.4*8MM Round-head Screws</td>
<td>6</td>
</tr>
<tr class="even">
<td>33</td>
<td><img src="/media/fb3d2a6b5e5de551ae702b94a468ab49.png" style="width:0.35486in;height:0.35486in" /></td>
<td>M1.4 Nuts</td>
<td>6</td>
</tr>
<tr class="odd">
<td>34</td>
<td><img src="/media/fb3d2a6b5e5de551ae702b94a468ab49.png" style="width:0.46806in;height:0.46806in" /></td>
<td>M2 Nuts</td>
<td>8</td>
</tr>
<tr class="even">
<td>35</td>
<td><img src="/media/f304cb590f040f13b4bd93bfc636ddba.png" style="width:0.68958in;height:0.41875in" /></td>
<td>M2*8MM Round-head Screws</td>
<td>8</td>
</tr>
<tr class="odd">
<td>36</td>
<td><img src="/media/1ae2d251fa671bdbedd375c37ed394aa.png" style="width:0.14653in;height:0.47431in" /></td>
<td>M1.2*5MM Round-head Screws</td>
<td>6</td>
</tr>
<tr class="even">
<td>37</td>
<td><img src="/media/f304cb590f040f13b4bd93bfc636ddba.png" style="width:1.06111in;height:0.64444in" /></td>
<td>M3*6MM Round-head Screws</td>
<td>18</td>
</tr>
<tr class="odd">
<td>38</td>
<td><img src="/media/f304cb590f040f13b4bd93bfc636ddba.png" style="width:1.18264in;height:0.71806in" /></td>
<td>M3*10MM Round-head Screws</td>
<td>3</td>
</tr>
<tr class="even">
<td>39</td>
<td><img src="/media/fb3d2a6b5e5de551ae702b94a468ab49.png" style="width:0.61458in;height:0.61458in" /></td>
<td>M3 Nuts</td>
<td>3</td>
</tr>
<tr class="odd">
<td>40</td>
<td><img src="/media/0e0fd3c7109c9fdaae633447ace2452f.png" style="width:1.80208in;height:0.30208in" /></td>
<td>M3*10MM Dual-pass Copper Pillar</td>
<td>4</td>
</tr>
<tr class="even">
<td>41</td>
<td><img src="/media/0e0fd3c7109c9fdaae633447ace2452f.png" style="width:1.80208in;height:0.30208in" /></td>
<td>M3*40MM Dual-pass Copper Pillar</td>
<td>4</td>
</tr>
<tr class="odd">
<td>42</td>
<td><img src="/media/f208158da83eb49a2fca4244c3f05347.png" style="width:1.44097in;height:0.60069in" /></td>
<td>43093 Blue Technic Axle Pin with Friction Ridges</td>
<td>13</td>
</tr>
<tr class="even">
<td>43</td>
<td><img src="/media/bcef2d126a80b57c944cc15d4df4ee07.png" style="width:0.85278in;height:0.80139in" /></td>
<td>4265c Technic Bush</td>
<td>13</td>
</tr>
<tr class="odd">
<td>44</td>
<td><img src="/media/95a430f19b519f4c80f1aee9bdea1605.png" style="width:1.66736in;height:0.16806in" /></td>
<td>Winding Pipe</td>
<td>.12</td>
</tr>
<tr class="even">
<td>45</td>
<td><img src="/media/247e99cde38f40eb256ed698ec47bb1d.png" style="width:1.55in;height:0.10625in" /></td>
<td>3*100MM Ties</td>
<td>5</td>
</tr>
<tr class="odd">
<td>46</td>
<td><img src="/media/ad46a09c801f0ce10448cf7f7c3ef279.png" style="width:0.53125in;height:1.40625in" /></td>
<td>L Type M2.5 Wrench</td>
<td>1</td>
</tr>
<tr class="even">
<td>47</td>
<td><img src="/media/ad46a09c801f0ce10448cf7f7c3ef279.png" style="width:0.53125in;height:1.40625in" /></td>
<td>L Type M3 Wrench</td>
<td>1</td>
</tr>
<tr class="odd">
<td>48</td>
<td><img src="/media/ad46a09c801f0ce10448cf7f7c3ef279.png" style="width:0.53125in;height:1.40625in" /></td>
<td>L Type M1.5 Wrench</td>
<td>1</td>
</tr>
<tr class="even">
<td>49</td>
<td><img src="/media/8810f202c4cfdc25b290754e21d2fdc8.png" style="width:1.70069in;height:1.11181in" /></td>
<td>Cardboard</td>
<td>1</td>
</tr>
</tbody>
</table>

5.  **Installation**

It is recommended to start the installation part after all projects are
learned.

<table>
<tbody>
<tr class="odd">
<td>Caution</td>
</tr>
<tr class="even">
<td><ol type="1">
<li><p>Set the initial angle of the servo</p></li>
</ol>
<p>Peel thin films off boards before installing this robot</p></td>
</tr>
</tbody>
</table>

<table>
<tbody>
<tr class="odd">
<td>Step 1</td>
<td></td>
</tr>
<tr class="even">
<td>Required Parts</td>
<td><img src="/media/51bcc9167e5685c36c36163cfa54721e.png" style="width:4.00694in;height:1.76528in" /></td>
</tr>
<tr class="odd">
<td><p><img src="/media/79cd39bc8b0cdd101d78b2d53e577949.png" style="width:5.67917in;height:3.86528in" /></p>
<p><img src="/media/2984a704f06e6fe498fad42f76464265.png" style="width:5.75069in;height:6.46667in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td>Step 2</td>
<td></td>
</tr>
<tr class="odd">
<td><p>Required</p>
<p>Parts</p></td>
<td><img src="/media/98b16329d76e0b5922019e374adbb6b0.png" style="width:4.13681in;height:4.13889in" /></td>
</tr>
<tr class="even">
<td><p><img src="/media/8ac582a66f30d6fc96cacb91ab346ddc.png" style="width:5.16944in;height:3.90694in" /></p>
<p><img src="/media/16a95f00c19b962ca26b89a2cb120aac.png" style="width:6.24236in;height:4.97222in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td>Step 3</td>
<td></td>
</tr>
<tr class="even">
<td>Required Parts</td>
<td><img src="/media/8cb0858d528dbc29cee3afc94d8f1385.jpeg" style="width:4.92153in;height:4.05208in" /></td>
</tr>
<tr class="odd">
<td><p><img src="/media/010870ff21b51bdcf5595470a0bdf80d.jpeg" style="width:4.71042in;height:4.24514in" /></p>
<p><img src="/media/1ed8d0bbd21abb743452a14b0566318d.jpeg" style="width:4.14097in;height:3.53333in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td>Step 4</td>
<td></td>
</tr>
<tr class="odd">
<td>Required Parts</td>
<td><img src="/media/4011d6d001c2ea028a9538ca49d87636.jpeg" style="width:5.42986in;height:4.51806in" /></td>
</tr>
<tr class="even">
<td><p><img src="/media/b02336401088ec3602ca6c2627ce03d5.jpeg" style="width:5.46458in;height:5.03958in" /></p>
<p><img src="/media/2b2ac9150f5b283a4c2045f596bf8f19.jpeg" style="width:5.50139in;height:3.60556in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td>Step 5</td>
<td></td>
</tr>
<tr class="even">
<td>Required Parts</td>
<td><img src="/media/5482dd9649abb2a727d1adc4ecc75d63.jpeg" style="width:4.00556in;height:4.25694in" /></td>
</tr>
<tr class="odd">
<td><p><img src="/media/4c7ff66d2c6ca61381d83bfe90983592.jpeg" style="width:4.14861in;height:3.42986in" /><img src="/media/86f32f920e7fa3aed2e4a82e3759e765.png" style="width:2.09792in;height:1.47986in" /></p>
<p><img src="/media/87923c4f858447f920eb0311df0fd734.jpeg" style="width:4.67569in;height:3.50139in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td>Step 6</td>
<td></td>
</tr>
<tr class="odd">
<td>Required Parts</td>
<td><img src="/media/bc9a480750a694277fe72a1a743cf616.jpeg" style="width:5.50347in;height:4.61875in" /></td>
</tr>
<tr class="even">
<td>Note: The direction of jumper caps</td>
<td><img src="/media/71b0b017fd3a713ea12cdef35688751d.jpeg" style="width:4.59306in;height:3.81806in" /></td>
</tr>
<tr class="odd">
<td></td>
<td><img src="/media/47f657a8da8ca1051b09ab42945335bb.jpeg" style="width:5.34097in;height:4.45208in" /></td>
</tr>
<tr class="even">
<td>Step 7</td>
<td></td>
</tr>
<tr class="odd">
<td>Required Parts</td>
<td><img src="/media/6a0447be5d1c8c410c35d7be569d8770.jpeg" style="width:5.31111in;height:4.09861in" /></td>
</tr>
<tr class="even">
<td><p><img src="/media/08c05216fcf38671b207b1769bf4923f.jpeg" style="width:5.16389in;height:3.38611in" /></p>
<p><img src="/media/a285db6d2b9ad77594d3e9a05fbc3c3e.jpeg" style="width:4.7in;height:3.96806in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td>Step 8</td>
<td></td>
</tr>
<tr class="even">
<td>Required Parts</td>
<td><img src="/media/20a0010d7d3a878f99ff92f410c3ee1c.jpeg" style="width:4.51667in;height:2.89861in" /></td>
</tr>
<tr class="odd">
<td><p><img src="/media/f6c4e6915d9555710ff230229047754d.jpeg" style="width:3.12361in;height:3.36667in" /></p>
<p><img src="/media/1b572444d27283340f630226bfdef9db.jpeg" style="width:3.45903in;height:3.03403in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td>Step 9（Need to adjust the angle of the servo）</td>
<td></td>
</tr>
<tr class="odd">
<td>Required Parts</td>
<td><img src="/media/dc2d99e73f28b619ff76f3c7afbf1f02.jpeg" style="width:5.10139in;height:3.08542in" /></td>
</tr>
<tr class="even">
<td><p><img src="/media/726e16efbb8fa4a3621ff9a6bb4cbb81.jpeg" style="width:4.53125in;height:4.80764in" /></p>
<p><img src="/media/f3662c6f199cda4605cf6592241e7e05.jpeg" style="width:3.90069in;height:3.45347in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td>Step 10</td>
<td></td>
</tr>
<tr class="even">
<td><p><img src="/media/ddefa9a9ca968eb25ad465ca1a4d7a1d.jpeg" style="width:5.83125in;height:4.61111in" /></p>
<p><img src="/media/ca539faaed2ee7f223cc30ae39ad4e40.jpeg" style="width:5.75139in;height:4.54375in" /></p>
<p><img src="/media/ae73791f2600e08c0b581a42ae30a219.jpeg" style="width:5.88472in;height:4.74514in" /></p>
<p><img src="/media/9ed881057af4477499c9f2215545de95.jpeg" style="width:5.84028in;height:4.18056in" /></p>
<p><img src="/media/8b0aa559a3ce44d747b652685064d08c.jpeg" style="width:5.95208in;height:4.85556in" /></p>
<p><img src="/media/87cb59391ecda4a3b9e707f7b268a823.jpeg" style="width:5.32153in;height:4.325in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td>Wiring up</td>
<td></td>
</tr>
<tr class="even">
<td><p>Hook Up the photo-resistor</p>
<p><img src="/media/3d03bb72f9c41a64a7aa5a052ffbc865.jpeg" style="width:4.77153in;height:4.07361in" /><img src="/media/6bd8e6f546e07468e134218f7bfdf0fb.jpeg" style="width:5.58681in;height:4.19028in" /><img src="/media/c12221f5a4fa5bf5afac4a7fda832fd4.png" style="width:4.74931in;height:4.31528in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td><p>Wire up the line tracking sensor</p>
<p><img src="/media/a59fc868fcb6fbc0c730a9b40a2e5075.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/67a6700f63480f299034068823a71c29.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/d9199bed87813603c5ea72d84c47cabc.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/99fbd4f55c270c0a29ce284dbdf58c75.png" style="width:5.87431in;height:4.10208in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td><p>Hook up the IR Receiver Module</p>
<p><img src="/media/08b33f7f68c47672059259e5ed05530c.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/fdc6d018f9bd921faff37504266b196c.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/13872c10e2dc6889da0b4203785bd67a.png" style="width:5.87361in;height:4.17014in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td><p>Wire up the Ultrasonic Sensor</p>
<p><img src="/media/caef69190626920963fad738d7dcc025.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/a5bdd6bb9bbe9db82c93e9193cbac4cd.png" style="width:5.87431in;height:3.61597in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td><p>Wire up the Servo</p>
<p><img src="/media/7e0ebd16b93d5a036623b631b5acdbd7.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/9aa3508d69cf0e26ea96f6975c64f2da.png" style="width:5.87361in;height:2.92222in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td><p>Hook Up the 8*16LED Panel</p>
<p><img src="/media/394180ba7ceaca71ccf0fecc214a0a8c.jpeg" style="width:6.04722in;height:4.78611in" /><img src="/media/f8ee5977f49e0edd9ae05bcc5f36d963.jpeg" style="width:5.82431in;height:4.36806in" /></p>
<p><img src="/media/564519cb6779c8fd154fca583c75728f.png" style="width:5.87361in;height:2.56319in" /></p></td>
<td></td>
</tr>
<tr class="even">
<td>Connection Diagram</td>
<td><img src="/media/a7f75858f0efba9fc59c04d8da25a699.png" style="width:4.52778in;height:3.39861in" /><img src="/media/99ad4d3071a93df85ed5b8e2791ccbd9.jpeg" style="width:4.4625in;height:3.34653in" /><img src="/media/119a162ca2397f04f4725e4d43c080ef.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/abca6294b5b5ac581a1abe62f0de814f.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/123be51cf2a2858f65233cc27c4d9c03.png" style="width:4.20833in;height:2.4875in" /></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td><p>Dismantle two photoresistors and ultrasonic sensor, as shown below</p>
<p><img src="/media/ebbee258470cfdaa9a0991aa903f719d.jpeg" style="width:4.92569in;height:3.89931in" /></p>
<p><img src="/media/9a7ae6dd68c07b01297162bc1015cf34.jpeg" style="width:4.67778in;height:3.89028in" /></p></td>
<td></td>
</tr>
<tr class="odd">
<td>Replace them with a fan module and two flame sensors</td>
<td><img src="/media/0c7302d6904665588fb8e1c31d75cdb8.jpeg" style="width:5.96875in;height:4.35764in" /></td>
</tr>
<tr class="even">
<td>Then we get a tank robot for extinguishing fire</td>
<td><img src="/media/93d3abece3b0a22e745d71faa02ef1ac.jpeg" style="width:4.51389in;height:3.54097in" /></td>
</tr>
<tr class="odd">
<td>Connection Diagram</td>
<td></td>
</tr>
<tr class="even">
<td>Hook up the fan module and two flame sensors</td>
<td><p><img src="/media/798ef670fc34e0ae7a3f4ca75f517fda.jpeg" style="width:2.71181in;height:3.00278in" /><img src="/media/51ccf21c903928ddf350636647eb6bd7.jpeg" style="width:5.82431in;height:4.36806in" /><img src="/media/18965780f2b562814976ebe6d9f18175.jpeg" style="width:2.67014in;height:3.025in" /><img src="/media/5344412ab7e7198a9d7296fb564cfeb0.jpeg" style="width:3.3625in;height:3.22014in" /></p>
<p><img src="/media/f3553c96c404c4d75073ea6f6f3a50fb.png" style="width:3.95556in;height:2.65764in" /></p></td>
</tr>
</tbody>
</table>

**6.****Install Arduino IDE and Driver**

1)  **Installing Arduino IDE**

When you get control board, you need to download Arduino IDE and driver
firstly.

You could download Arduino IDE from the official website:

<https:/www.arduino.cc/>, click the **SOFTWARE** on the browse bar,
click“DOWNLOADS”to enter download page, as shown below:

![](/media/4636aac9aca9b3aa9d86580caac51b81.png)

There are various versions of IDE for Arduino. Just download a version
compatible with your system. Here we will show you how to download and
install the windows version of Arduino IDE.

![](/media/3d3e36e47f8c7009155f0e8cc256ead1.png)

There are two versions of IDE for WINDOWS system. You can choose between
the installer (.exe) and the Zip file. For installer, it can be directly
downloaded, without the need of installing it manually. However, for Zip
package, you will need to install the driver manually.

![](/media/745910f7138b08d5cbcb557f194b0679.png)

Click JUST DOWNLOAD.

2)  **Keyestudio V4.0 Development Board**

You need to know that keyestudio V4.0 development board is the core of
this smart car.

![](/media/3b23d2c1112ba26a0c7ae9914ec14312.png)

Keyestudio V4.0 development board is based on ATmega328P MCU, and with a CP2102 Chip as a UART-to-USB converter.  

![](/media/308315eef3c603cdf0e8babfc4d9c297.jpeg)

It has 14 digital input/output pins (of which 6 can be used as PWM outputs), 6 analog inputs, a 16 MHz quartz crystal, a USB connection, a power jack, 2 ICSP headers and a reset button.

![](/media/9652daf1229f38442c4c31934022be39.png)

We can power it with a USB cable, the external DC power jack 

(DC 7-12V) or female headers Vin/ GND(DC 7-12V)

<table>
<tbody>
<tr class="odd">
<td>Micro controller</td>
<td>ATmega328P-PU</td>
</tr>
<tr class="even">
<td>Operating Voltage</td>
<td>5V</td>
</tr>
<tr class="odd">
<td>Input Voltage (recommended)</td>
<td>DC7-12V</td>
</tr>
<tr class="even">
<td>Digital I/O Pins</td>
<td><p>14 (D0-D13)</p>
<p>(of which 6 provide PWM output)</p></td>
</tr>
<tr class="odd">
<td>PWM Digital I/O Pins</td>
<td>6 (D3, D5, D6, D9, D10, D11)</td>
</tr>
<tr class="even">
<td>Analog Input Pins</td>
<td>6 (A0-A5)</td>
</tr>
<tr class="odd">
<td>DC Current per I/O Pin</td>
<td>20 mA</td>
</tr>
<tr class="even">
<td>DC Current for 3.3V Pin</td>
<td>50 mA</td>
</tr>
<tr class="odd">
<td>Flash Memory</td>
<td>32 KB (ATmega328P-PU) of which 0.5 KB used by bootloader</td>
</tr>
<tr class="even">
<td>SRAM</td>
<td>2 KB (ATmega328P-PU)</td>
</tr>
<tr class="odd">
<td>EEPROM</td>
<td>1 KB (ATmega328P-PU)</td>
</tr>
<tr class="even">
<td>Clock Speed</td>
<td>16 MHz</td>
</tr>
<tr class="odd">
<td>LED_BUILTIN</td>
<td>D13</td>
</tr>
</tbody>
</table>

3)  **Installing the Driver of the V4.0 Board**

Let’s install the driver of keyestudio V4.0 board. The USB-TTL chip on
V4.0 board adopts CP2102 serial chip. The driver program of this chip is
included in Arduino 1.8 version and above
(<https:/www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers>),
which is convenient. Plugging on USB port of board, the computer can
recognize the hardware and automatically install the driver of CP2102.

If you install unsuccessfully, or intend to install manually, please
open the device manager of computer. Right click Computer-----
Properties----- Device Manager

![](/media/afa5b0dde9342bd7ad9f385333cb6f55.png)

The yellow exclamation mark on the page implies an unsuccessful
installation and you should double click the hardware and update the
driver.

![](/media/c26ca0ef1bf1506c815b6e3e239cf525.png)

> Click“OK”to enter the following page. Click“browse my computer for
> updated driver software”
> 
> ![](/media/4ec7a5ea3c8a1fd9663eef4768b687c5.png)
> 
> Click “Browse”, then search the driver of CP2102 and click “Next”,
> 
> There is a DRIVERS folder in Arduino software installed
> package（![](/media/f50a31a59716594afbd7c2254cfd521e.png)）, open driver folder and check the
> driver of CP210X series chips.
> 
> ![](/media/417de936fa9720c7a7427c4d07718292.png)
> 
> When opening the device manager, we will find the yellow exclamation
> mark disappear. The driver of CP2102 is installed successfully.
> 
> ![](/media/efce0ba96c48d853f302730b4d481ee9.jpeg)

![](/media/9b8ddc1c8af12e5f363817d49cea8571.png)

4)  **Arduino IDE Setting**

Click![](/media/675ae7298ce0973df720b2fbbb514caa.png)icon，and open Arduino IDE.

![](/media/9539afc53856fb021e9a1ebfd046e25a.png)

When downloading the sketch to the board, you must select the correct
name of Arduino board that matches the board connected to your computer.
As shown below;

![](/media/52a4a83ea3c5cc893fe54bec8d71c7d9.png)

Then select the correct COM port (you can see the corresponding COM port
after the driver is successfully installed)

![](/media/9b8ddc1c8af12e5f363817d49cea8571.png)

![](/media/cf6578993800712a41898f4fc7527ae3.png)

![](/media/54135d610cd0f7470cef7f89ca04df45.png)

A- Used to verify whether there is any compiling mistakes or not.

B- Used to upload the sketch to your Arduino board.

C- Used to create shortcut window of a new sketch.

D- Used to directly open an example sketch.

E- Used to save the sketch.

F- Used to send the serial data received from board to the serial
monitor.

5)  **Start First Program**

Open the file to select **Example**, and click **BASIC**\>**BLINK**, as
shown below:

![](/media/ec55de813fc80e5508dc2eab34f223c8.png)

![](/media/b105203a78f032101841be899ca23ba4.png)

Set the correct **COM port,** and the corresponding board and COM port
are shown on the lower right of IDE.

![](/media/013c667ac68859ed97a1f451ee05380b.png)

Click![](/media/ddd21c81338ae1f6b7f84de2a3caecf0.png)to start compiling the program, and check
errors.

![](/media/fa97797b2bbcca9d4a91117398bd77d0.png)

Click![](/media/9c9158a5d49baa740ea2f0048f655017.png)to upload the program

![](/media/d15a8d62cf9777001924a2ff8113d13a.png)

After the program is uploaded successfully, the onboard LED blinks.
Congratulation, you finish the first program.

**7. How to Add a Library?**

**(1) What are Libraries ?**

[Libraries ](https:/www.arduino.cc/en/Reference/Libraries)are a
collection of code that make it easy for you to connect a
sensor,display, module, etc.

For example, the built-in LiquidCrystal library helps talk to LCD
displays. There are hundreds of additional libraries available on the
Internet for download.

The built-in libraries and some of these additional libraries are listed
in the reference. 

**(2) How to Install a Library ?**

Here we will introduce the most simple way to add libraries .

**Step 1：**After downloading well the Arduino IDE, you can right-click
the icon of Arduino IDE.

Find the option "Open file location"

![](/media/f1d5fd3883e0997ca46dcf8513733c46.png)

**Step 2:** Click Open file location \>libraries

![](/media/d65edbf3dd79595c741e7e7049334e90.png)

**Step 3：**Next, find out the“libraries”folder of tank robot(seen in the
link: https:/fs.keyestudio.com/KS0526)

Copy them into libraries of Arduino

![](/media/ef128138a3b57f2927bf35784021c13a.png)

**8. Projects**

Note: (G), marked on each sensor and module, is the negative pole and
connected to“G”, ”-”or “GND”on the sensor shield or control board ; (V)
is the positive pole and linked with V , VCC, + or 5V on the sensor
shield or control board.

**Project 1****: LED Blinks**

(1) Description：

![](/media/ae87aea86f6c7e427f7adfc0e7c0efe3.png)

For starters and enthusiasts, LED Blink is a fundamental program. LED,
the abbreviation of light emitting diodes, consists of Ga, As, P, N
chemical compounds and so on. The LED can flash in diverse colors by
altering the delay time in the test code. When in control, power on GND
and VCC, the LED will be on if S end is in high level; nevertheless, it
will go off.

![](/media/0ea85307e1317c25f2a8d92f25319aa8.png)(2）Parameters：

Control interface: digital port

Working voltage: DC 3.3-5V

Pin spacing: 2.54mm

LED display color: yellow

(3) Components Needed:

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor Driver </p>
<p>Shield*1</p></td>
<td>Yellow LED Module*1</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.74097in;height:1.25694in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:2.01042in;height:1.61458in" /></td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:2.13889in;height:1.70486in" /></td>
</tr>
<tr class="odd">
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)</td>
<td>USB Cable*1</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.87986in;height:1.70417in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.80208in;height:0.66667in" /></td>
<td></td>
</tr>
</tbody>
</table>

(4) Motor Drive Shield V2：

There are many ways to drive a motor. Our robot car uses the most common
solution--L298P--which is an excellent high-power motor driver IC
produced by STMicroelectronics. It can directly drive DC motors,
two-phase and four-phase stepping motors. The driving current is up to
2A, and the output terminal of motor adopts eight high-speed Schottky
diodes as protection.

We designed a shield based on the circuit of L298p.

The stacked design reduces the technical difficulty of using and driving
the motor.

![](/media/693acafee3fa4f31c8067009b193f2b1.png)

6)  Connection Diagram：

![](/media/d4b4ac75507402fce61ee29ed00ff7a8.png)

LED is connected to D3 port, and remember to install jumper caps onto
the shield

7)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 1.1

Blink

http:/www.keyestudio.com

\*/

int LED = 3; /Define the pin of LED to connect with digital port 3

void setup()



void loop() /Form an infinite loop



8)  Test Results：

Upload the program, LED blinks at the interval of 1s.

9)  Code Explanation:

**pinMode(LED，OUTPUT) -** This function can denote that the pin is INPUT
or OUTPUT

**digitalWrite(LED，HIGH) -** When pin is OUTPUT, we can set it to
HIGH(output 5V) or LOW(output 0V)

(9)Extension Practice:：

We have succeeded in blinking LED. Next, let’s observe what will happen
to the LED if we modify pins and delay time.

/\*

keyestudio Mini Tank Robot V3

lesson 1.2

Blink

http:/www.keyestudio.com

\*/

int LED = 3; /Define the pin of LED to connect with digital port 3

void setup()



void loop() /Form an infinite loop



The test result shows that the LED flashes faster. Therefore, we can
draw a conclusion that pins and time delaying affect flash frequency.

**Project 2: Adjust LED Brightness**

(1) Description：

In previous lesson, we control LED on and off and make it blink.

In this project, we will control LED’s brightness through PWM simulating
breathing effect. Similarly, you can change the step length and delay
time in the code so as to demonstrate different breathing effects.

PWM is a means of controlling the analog output via digital means.
Digital control is used to generate square waves with different duty
cycles (a signal that constantly switches between high and low levels)
to control the analog output.In general, the input voltages of ports are
0V and 5V. What if the 3V is required? Or a switch among 1V, 3V and
3.5V? We cannot change resistors constantly. For this reason, we resort
to PWM.

![](/media/bbcfcb9ae56abb7e80ee587246fc4be9.GIF)

For Arduino digital port voltage outputs, there are only LOW and HIGH
levels, which correspond to the voltage outputs of 0V and 5V
respectively. You can define LOW as“0”and HIGH as“1’, and let the
Arduino output five hundred‘0’or‘1’within 1 second. If output five
hundred‘1’, that is 5V; if all of which is‘0’,that is 0V; if output 250
01 pattern, that is 2.5V.

This process can be likened to showing a movie. The movie we watch are
not completely continuous. Actually, it generates 25 pictures per
second, which cannot be told by human eyes. Therefore, we mistake it as
a continuous process. PWM works in the same way. To output different
voltages, we need to control the ratio of 0 and 1. The more‘0’or‘1’
output per unit time, the more accurate the control.

(2) Parameters：

![](/media/0ea85307e1317c25f2a8d92f25319aa8.png)

Control interface: Digital port 3

Working voltage: DC 3.3-5V

Pin spacing: 2.54mm

LED display color: yellow

3)  Components Needed:：

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor </p>
<p>Driver </p>
<p>Shield*1</p></td>
<td>Yellow LED Module*1</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.74097in;height:1.25694in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.54653in;height:1.24236in" /></td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:2.13889in;height:1.70486in" /></td>
</tr>
<tr class="odd">
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)*1</td>
<td>USB Cable*1</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.87986in;height:1.70417in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.80208in;height:0.66667in" /></td>
<td></td>
</tr>
</tbody>
</table>

4)  Connection Diagram：

![](/media/d4b4ac75507402fce61ee29ed00ff7a8.png)

5)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 2.1

pwm

http:/www.keyestudio.com

\*/

int LED = 3; /Define the pin of LED to connect with digital port 3

void setup () 

void loop () 

for (int value = 255; value \> 0; value = value - 1) 

}

6)  Test Results：

Upload test code successfully, LED gradually changes from bright to
dark, like human’s breath, rather than turning on and off immediately.

7)  Code Explanation:
    
    To repeat some certain statements, we could use FOR statement. FOR
    statement format is shown below:

![](/media/65da124bdd0ea488291c71c6b879fe95.jpeg)

FOR cyclic sequence:

Round 1：1 → 2 → 3 → 4

Round 2：2 → 3 → 4

…

Until number 2 is not established, “for”loop is over.

After knowing this order, go back to code:

**for (int value = 0; value \< 255; value=value+1)**

**for (int value = 255; value \>0; value=value-1)**

The two“for”statements make value increase from 0 to 255, then reduce
from 255 to 0, then increase to 255,....infinitely loop

There is a new function in the following ----- analogWrite()

We know that digital port only has two state of 0 and 1. So how to send
an analog value to a digital value? Here,this function is needed. Let’s
observe the Arduino board and find 6 pins marked“\~”which can output PWM
signals.

Function format as follows:

**analogWrite(pin,value)**

analogWrite() is used to write an analog value from 0\~255 for PWM port,
so the value is in the range of 0\~255. Attention that you only write
the digital pins with PWM function, such as pin 3, 5, 6, 9, 10, 11.

PWM is a technology to obtain analog quantity through digital method.
Digital control forms a square wave, and the square wave signal only has
two states of turning on and off (that is, high or low levels). By
controlling the ratio of the duration of turning on and off, a voltage
varying from 0 to 5V can be simulated. The time turning on(academically
referred to as high level) is called pulse width, so PWM is also called
pulse width modulation.

Through the following five square waves, let’s acknowledge more about
PWM.

![](/media/553f3d1b6ca04e1aa0479841dd075fa2.png)

In the above figure, the green line represents a period, and value of
analogWrite() corresponds to a percentage which is called Duty Cycle as
well. Duty cycle implies that high-level duration is divided by
low-level duration in a cycle. From top to bottom, the duty cycle of
first square wave is 0% and its corresponding value is 0. The LED
brightness is lowest, that is, light off. The more time the high level
lasts, the brighter the LED. Therefore, the last duty cycle is 100%,
which correspond to 255, and LED is the brightest. And 25% means darker.

PWM mostly is used for adjusting the LED’s brightness or the rotation
speed of motors.

It plays a vital role in controlling smart robot cars. I believe that
you cannot wait to learn next project.

(8) Extension Practice：

Let’s modify the value of delay and remain the pin unchanged, then
observe how LED changes.

/\*

keyestudio Mini Tank Robot V3

lesson 2.2

pwm-slow

http:/www.keyestudio.com

\*/

int LED = 3; /Define the pin of LED to connect with digital port 3

void setup () 

void loop () 

for (int value = 255; value \> 0; value = value - 1) 

}

Upload the code to development board, LED flashes more slowly.

## **Project 3: Photoresistor**

![](/media/36e7e08764ed3c61a1c22f86be8c23d9.jpeg)

(1) Description：

The photosensitive resistor is a special resistor made of a
semiconductor material such as a sulfide or selenium, and a
moisture-proof resin is also coated with a photoconductive effect. The
photosensitive resistance is most sensitive to the ambient light,
different illumination strength, and the resistance of the
photosensitive resistance is different. We use the photosensitive
resistance to design the photosensitive resistor module. The module
signal is connected to the microcontroller analog port. When the light
intensity is stronger, the larger the analog port voltage, that is, the
simulation value of the microcontroller is also large; in turn, when the
light intensity is weaker, the smaller the analog port voltage, that is,
the simulation value of the microcontroller is also small. . In this
way, we can read the corresponding analog value using the photosensitive
resistor module, and the intensity of the light in the inductive
environment.

2)  ![](/media/0d9daba6454ef099fe1ceb0e6cb56ec4.png)Parameters：

Photosensitive resistance resistance value: 5K Ou-0.5m

Interface type: simulation port A0, A1

Working voltage: 3.3V-5V

Pin spacing: 2.54mm

3)  Components Needed:

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor </p>
<p>Driver </p>
<p>Shield*1</p></td>
<td>Yellow LED Module*1</td>
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)*1</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.43403in;height:1.03542in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.45833in;height:1.17153in" /></td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:1.13889in;height:1.02014in" /></td>
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.68472in;height:1.32639in" /></td>
</tr>
<tr class="odd">
<td>Photoresistor *1</td>
<td>3P-3P XH2.54 to PH2.0 Dupont Wire（Yellow-Red-Black)*1</td>
<td>USB Cable*1</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/9b0193c19a5a7392052adffdfc4e10c2.png" style="width:1.17986in;height:1.09722in" /></td>
<td><img src="/media/f493282b2846fe01fe6861126b368480.png" style="width:0.93958in;height:1.60556in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.20486in;height:0.44583in" /></td>
<td></td>
</tr>
</tbody>
</table>

4)  Connection Diagram
    
    ![](/media/80a6d1141c4010d9b95e42c4993f9e14.png)

We connect a photoresistor to A0 and make an experiment.

Let’s read its analog value first.

5)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 3.1

photocell

http:/www.keyestudio.com

\*/

int sensorPin = A1; / A1 is the input pin of photoresistor

int sensorValue = 0; / save the value of photoresistors

void setup() 

void loop() 

6)  Test Results：

![](/media/0e2fe0d2eb2b427af79c7cb76b2d9f3f.png)

When covering it, the value gets smaller; if not, the value gets larger

7)  Code Explanation:

**analogRead(sensorPin)：read the analog value of photoresistors**

**Serial.begin(9600)：initialize serial port and set baud rate to 9600**

**Serial.println：**serial prints

8)  Extension Practice:

We know the value of the photoresistor. How about controlling the LED’s
brightness by it?

![](/media/7199a5af4f031c3c10120dca0ca91cf4.png)

The LED’s brightness is controlled by PWM. Therefore, we connect the LED
to PMW pin(pin 3) of the shield.

/\*

keyestudio Mini Tank Robot V3

lesson 3.2

photocell-analog output

http:/www.keyestudio.com

\*/

int analogInPin = A0; / A1 is the input pin of photoresistor

int analogOutPin = 3; / Digital port 3 is the output of PMW

int sensorValue = 0; / save the variable of the resistance value of
photoresistors

int outputValue = 0; / Value output to PMW

void setup() 

void loop() 

Upload code to the development board, then cove the photoresistor and
observe the LED’s brightness.

**Project 4: Line Tracking Sensor**

(1) Description：

![](/media/d37c24e508361ab86b019135ab6950a9.png)

The tracking sensor is actually an infrared sensor. The component used
here is the TCRT5000 infrared tube.

Its working principle is to use different reflectivity of infrared light
to colors, then convert the strength of the reflected signal into a
current signal.

During the process of detection, black is active at HIGH level while
white is active at LOW level. The detection height is 0-3 cm.

Keyestudio 3-channel line tracking module has integrated 3 sets of
TCRT5000 infrared tube on a single board, which is more convenient for
wiring and control.

By rotating the adjustable potentiometer on the sensor, it can adjust
the detection sensitivity of the sensor.

2)  Parameters：

Operating Voltage: 3.3-5V (DC)

Interface: 5PIN

Output Signal: Digital signal

Detection Height: 0-3 cm

Special note: before testing,rotate the potentiometer on the sensor to
adjust the detection sensitivity. When adjust the LED at the threshold
between ON and OFF, the sensitivity is the best.

3)  Components Needed:

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor </p>
<p>Driver Shield</p></td>
<td>Yellow LED Module*1</td>
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)*1</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.36181in;height:0.98333in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.55694in;height:1.25069in" /></td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:1.64861in;height:1.31458in" /></td>
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.72431in;height:1.40278in" /></td>
</tr>
<tr class="odd">
<td>Tank Robot Chassis *1</td>
<td>5P JST-PH2.0MM Dupont Wire*1</td>
<td>USB Cable*1</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/686670898705c411f9affbd3e2e78c61.png" style="width:1.31667in;height:1.05486in" /></td>
<td><img src="/media/9be46d555e20cfcf32b981ccd90a376f.png" style="width:0.82083in;height:1.54653in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.47708in;height:0.54653in" /></td>
<td></td>
</tr>
</tbody>
</table>

Note: the line tracking sensor is installed under the bottom of the
robot.

4)  Connection Diagram：

![](/media/99fbd4f55c270c0a29ce284dbdf58c75.png)

5)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 4.1

Line Track sensor

http:/www.keyestudio.com

\*/

/The wiring of line tracking sensors

\#define L\_pin 6 /for the sensor in the left

\#define M\_pin 7 /for the sensor in the middle

\#define R\_pin 8 /for the sensor in the right

void setup()



void loop ()



6)  Test Results：

Upload the code on development board, open serial monitor to check line
tracking sensors. And the displayed value is 1(high level) when no
signals are received. The value shifts into 0 when the sensor is covered
with paper.

![](/media/b9319753c148f66aabc9bf648ed93da1.png)

7)  Code Explanation:

**Serial.begin(9600)**- Initialize serial port, set baud rate to 9600

**pinMode- **Define the pin as input or output mode

**digitalRead-**Read the state of pin, which are generally HIGH and LOW
level

(8)Extension Practice：

After knowing its working principle, you can connect an LED to D3. so as
to control LED by line tracking sensor.

![](/media/afd08e733c4e3e7f3357c243e9730579.png)

/\*

keyestudio Mini Tank Robot V3

lesson 4.2

Line Track sensor

http:/www.keyestudio.com

\*/

/LED pin

\#define LED 3

/The wiring of line tracking sensors

\#define L\_pin 6 /for the sensor in the left

\#define M\_pin 7 /for the sensor in the middle

\#define R\_pin 8 /for the sensor in the right

void setup()

void loop ()

else 

}

**Project 5: Flame Sensor**

![](/media/7cf8c051f489b06119c262cd059c23c5.jpeg)

1)  Description：

The flame sensor uses IR receiving tube to detect flames, converts the
brightness of the flame into signals with high and low levels, input
them into the central processor. The corresponding program processing.
In both flames close to and without flames, the voltage value of the
analog port is varied.

If there is no flame, the analog port is about 0.3V; when there is a
flame, the analog port is 1.0V. The closer the flame is , the more the
voltage value is. It can be used to detect the fire source or make a
smart robot.

Note the probe of flame sensors only bears the temperature between -25
℃and ～85℃

In the process of use, pay attention to keep the flame sensor in certain
distance to avoid getting damaged.

2)  Parameters：

![](/media/e2c77a94067ccd3e634fb3674c02b80f.png)

Working voltage: 3.3V-5V (DC)

Current: 100mA

Maximum power: 0.5W

Work temperature: -10 ° C to +50 degrees Celsius

Sensor size: 31.6mmx23.7mm

Interface: 4pin turn 3PIN interface

Output signal: analog signals A0, A1

3)  Components Needed:

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor </p>
<p>Driver Shield</p></td>
<td>Yellow LED Module*1</td>
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)*1</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.46875in;height:1.06042in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.27986in;height:1.02778in" /></td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:1.16667in;height:0.85417in" /></td>
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.87986in;height:1.70417in" /></td>
</tr>
<tr class="odd">
<td>Flame Sensor*1</td>
<td><p>4P-3P XH2.54 to PH2.0</p>
<p>Dupont Wire（Yellow-Red-Black)</p></td>
<td>USB Cable*1</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/ecf808f114234039582880ab4682c4e6.png" style="width:1.42014in;height:1.01319in" /></td>
<td><img src="/media/7856a38f34cdeb19966cd0fb99b55f85.png" style="width:1.18403in;height:1.47292in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.11944in;height:0.41389in" /></td>
<td></td>
</tr>
</tbody>
</table>

4)  Connection Diagram：

![](/media/33201c33dc7d202651bb2ff3b6c082c8.png)

We can use two flame sensors to make a fire-distinguishing robot car.
But in this experiment, we aim to read its analog value

5)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 5.1

flame sensor

http:/www.keyestudio.com

\*/

int flame = A1; /Define the flame pin as analog pin A1

int val = 0; /Define digital variables

void setup() 

void loop() 

6)  Test Result：

Wire up components, burn the code, open the serial monitor and set the
baud rate to 9600.

You can view the simulation value of flame sensor.

The closer the flame, the smaller the simulation value.

Adjust the potentiometer on the module to maintain D1 at the critical
point. When the sensor does not detect flame, the D1 will be off, but if
the sensor detects flame, the D1 will be on.

![](/media/05db06b3e205dfca63c2ba3aa7ff528e.png)

7)  Extension Practice:

Next, connect an LED to pin 3 and we can control it by a flame sensor,
as shown below;

![](/media/b0fd48ba642ff3ae189cc27270a32a92.png)

/\*

keyestudio Mini Tank Robot V3

lesson 5.2

flame sensor

http:/www.keyestudio.com

\*/

int flame = A0; /Define the flame pin as analog pin A0

int LED = 3; /Define the LED as digital port 3

int val = 0; /Define digital variables

void setup() 

void loop()  else 

delay(50); /Delay in 50ms

}

**Project 6: Fan**

(1) Description：

![](/media/4afc1c9720d36beba8adfac0ee22ff10.png)

This fan module uses a HR1124S motor-controlling chip, a single-channel
H-bridge driver chip containing a low-conductivity resistance PMOS and
NMOS power tubes. The low-conducting resistance can ease the power
consumption, contributing to the safe work of the chip for longer time.

In addition, its low standby current and low static working current
makes itself apply to toys. We can control the rotation direction and
speed of the fan by outputting IN + and IN- signals and PWM signals.

![](/media/0ea85307e1317c25f2a8d92f25319aa8.png)(2）Parameters：

Working voltage: 5V

Current: 200mA

Maximum power: 2W

Work temperature: -10 ° C to +50 degrees Celsius

Size: 47.6mm \* 23.8mm

2)  Components Needed:

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor </p>
<p>Driver Shield</p></td>
<td>130 Motor *1</td>
<td><p>4P XH2.54 to PH2.0</p>
<p>Dupont Wire（Green-Blue-Red-Black) *1</p></td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.34306in;height:0.97014in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.3375in;height:1.07431in" /></td>
<td><img src="/media/ec37bc098e230744bac2fb22b91c503e.png" style="width:0.94028in;height:0.77986in" /></td>
<td><img src="/media/26ed32284d40ce65cc336eb952755e64.png" style="width:1.23403in;height:1.31458in" /></td>
</tr>
<tr class="odd">
<td>Flame Sensor*1</td>
<td>4P-3P XH2.54 to PH2.0 Dupont Wire（Yellow-Red-Black)</td>
<td>USB Cable*1</td>
<td>Tank Robot Chassis</td>
</tr>
<tr class="even">
<td><img src="/media/ecf808f114234039582880ab4682c4e6.png" style="width:1.4625in;height:0.79722in" /></td>
<td><img src="/media/7856a38f34cdeb19966cd0fb99b55f85.png" style="width:1.34861in;height:1.44028in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.13819in;height:0.42153in" /></td>
<td><img src="/media/686670898705c411f9affbd3e2e78c61.png" style="width:1.62222in;height:1.21806in" /></td>
</tr>
</tbody>
</table>

The fan module needs driving by large current; therefore, we install a
battery holder.

3)  Connection Diagram：

![](/media/197065ceb15f48177279ac66ce0d80be.png)

The pin GND, VCC, IN+ and IN- of the fan module are connected to pin G,
V, 12 and 13 of the shield.

4)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 6.1

130 motor

http:/www.keyestudio.com

\*/

int INA = 12;

int INB = 13;

void setup() 

void loop() 

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

5)  Test Results：

Upload code, wire up components and plug in power. The small fan will
turn anticlockwise for 3000ms, stop for 1000ms, and clockwise for 300ms.

6)  Extension Practice:

We have understood the working principle of the flame sensor. Next, hook
up a flame sensor in the circuit , as shown below. Then control the fan
to blew out fire with the flame sensor.

![](/media/85f638b1905aa1c8ee676412c4a4fb87.png)

/\*

keyestudio Mini Tank Robot V3

lesson 6.2

130 motor

http:/www.keyestudio.com

\*/

int INA = 12;

int INB = 13;

int flame = A0; /Define the flame pin as analog pin A0

int val = 0; /Define digital variables

void setup() 

void loop()  else 

}

**Project 7: Servo Control**

1)  Description

Servo motor is a position control rotary actuator. It mainly consists of
a housing, a circuit board, a core-less motor, a gear and a position
sensor. Its working principle is that the servo receives the signal sent
by MCU or receiver and produces a reference signal with a period of 20ms
and width of 1.5ms, then compares the acquired DC bias voltage to the
voltage of the potentiometer and obtain the voltage difference output.

When the motor speed is constant, the potentiometer is driven to rotate
through the cascade reduction gear, which leads that the voltage
difference is 0, and the motor stops rotating. Generally, the angle
range of servo rotation is 0° --180 °

The rotation angle of servo motor is controlled by regulating the duty
cycle of PWM (Pulse-Width Modulation) signal. The standard cycle of PWM
signal is 20ms (50Hz). Theoretically, the width is distributed
between 1ms-2ms, but in fact, it's between 0.5ms-2.5ms. The width
corresponds the rotation angle from 0° to 180°. But note that for
different brand motors, the same signal may have different rotation
angles. 

![](/media/69be958142b773acdae33eeef12afed7.png)

In general, servo has three lines in brown, red and orange. The brown
wire is grounded, the red one is a positive pole line and the orange one
is a signal line.

![](/media/49467dfa70799401a5a5acc691014aee.png)

The angle of the servo:

![](/media/ddc74f62dc936c925d28d70a1a9c2214.png)

2)  Parameters：

Working voltage: DC 4.8V \~ 6V

Operating angle range: about 180 ° (at 500 → 2500 μsec)

Pulse width range: 500 → 2500 μsec

No-load speed: 0.12 ± 0.01 sec / 60 (DC 4.8V) 0.1 ± 0.01 sec / 60 (DC
6V)

No-load current: 200 ± 20mA (DC 4.8V) 220 ± 20mA (DC 6V)

Stopping torque: 1.3 ± 0.01kg · cm (DC 4.8V) 1.5 ± 0.1kg · cm (DC 6V)

Stop current: ≦ 850mA (DC 4.8V) ≦ 1000mA (DC 6V)

Standby current: 3 ± 1mA (DC 4.8V) 4 ± 1mA (DC 6V)

(3) Components Needed:

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>L298P Motor </p>
<p>Driver Shield</p></td>
<td>Yellow LED Module*1</td>
<td>3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)*1</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.21944in;height:0.88056in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.26458in;height:0.98264in" /></td>
<td><img src="/media/0b130b1b8eb4e626a9cad08906af2ef5.png" style="width:1.23264in;height:0.99514in" /></td>
<td><img src="/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png" style="width:0.78889in;height:1.52778in" /></td>
</tr>
<tr class="odd">
<td>HC-SR04 Ultrasonic Sensor*1</td>
<td>4P M-F PH2.0mm to 2.54 Dupont Wire</td>
<td>USB Cable*1</td>
<td>Tank Robot Chassis *1</td>
</tr>
<tr class="even">
<td><img src="/media/b0906d68835b2659491e53a85567569b.png" style="width:1.47569in;height:0.82153in" /></td>
<td><img src="/media/a3d702d65769c0e0b682a77a152ca5cc.png" style="width:0.60417in;height:1.58403in" /></td>
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.20486in;height:0.44583in" /></td>
<td><img src="/media/686670898705c411f9affbd3e2e78c61.png" style="width:1.44028in;height:1.20069in" /></td>
</tr>
</tbody>
</table>

(4) Connection Diagram：

![](/media/9aa3508d69cf0e26ea96f6975c64f2da.png)

Note: The brown, red and orange wire of the servo are respectively
attached to Gnd(G), 5v(V) and 10 of the shield. Remember to connect an
external power because of the high current of the servo. If not, the
development board will be burnt out.

5)  Test Code1：

/\*

keyestudio Mini Tank Robot V3

lesson 7.1

Servo

http:/www.keyestudio.com

\*/

\#define servoPin 10 /The pin of servo

int pos; /The variable of servo’s angle

int pulsewidth; /The variable of servo’s pulse width

void setup() 

void loop() 

for (pos = 180; pos \>= 0; pos -= 1) 

}

/The function controls the servo

void procedure(int myangle) 

Upload code, we will see the servo move from 0° to 180°. In the further
chapters, we will introduce how to drive a servo. Additionally, we can
control a servo with a servo library of Arduino.

You can refer to the use of the servo library:
<https:/www.arduino.cc/en/Reference/Servo>.

6)  Test Code2:

/\*

keyestudio Mini Tank Robot V3

lesson 7.2

Servo

http:/www.keyestudio.com

\*/

\#include \<Servo.h\>

Servo myservo; /

int pos = 0; / Save the variables of angle

void setup() 

void loop() 

for (pos = 180; pos \>= 0; pos -= 1) 

}

7)  Test Results：

Upload code, plug in power and servo moves in the range of 0° and 180°.

8)  Code Explanation
    
    Arduino comes with **\#include \<Servo.h\>** (servo function and
    statement）

The following are some common statements of the servo function:

1\. **attach（interface）**——Set servo interface, port 9 and 10 are
available

2\. **write（angle）**——The statement to set rotation angle of servo, the
angle range is from 0° to 180°

3\. **read（）**——The statement to read angle of servo, read the command
value of “write()”

4\. **attached（）**——Judge if the parameter of servo is sent to its
interface

Note: The above written format is“servo variable name, specific
statement（）”, for instance: myservo.attach(9)

## **Project 8: Ultrasonic Sensor** 

1)  **Description：**

![](/media/0180b169a1c3b228394b43df704fac32.png)

The HC-SR04 ultrasonic sensor uses sonar to determine distance to an
object like what bats do. It offers excellent non-contact range
detection with high accuracy and stable readings in an easy-to-use
package. It comes complete with ultrasonic transmitter and receiver
modules.

The HC-SR04 or the ultrasonic sensor is being used in a wide range of
electronics projects for creating obstacle detection and distance
measuring application as well as various other applications. Here we
have brought the simple method to measure the distance with arduino and
ultrasonic sensor and how to use ultrasonic sensor with arduino.

![](/media/0ea85307e1317c25f2a8d92f25319aa8.png)(2）Parameters：

Power Supply :+5V DC

Quiescent Current : \<2mA

Working Current: 15mA

Effectual Angle: \<15°

Ranging Distance : 2cm – 400 cm

Resolution : 0.3 cm

Measuring Angle: 30 degree

Trigger Input Pulse width: 10uS

**(3) Components Needed:**

|                                       |                                    |                          |                                                       |
| ------------------------------------- | ---------------------------------- | ------------------------ | ----------------------------------------------------- |
| Keyestudio V4.0 Development Board \*1 | L298P Motor Driver Shield          | Yellow LED Module\*1     | 3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)\*1 |
| ![](/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png)                              |
| HC-SR04 Ultrasonic Sensor\*1          | 4P M-F PH2.0mm to 2.54 Dupont Wire | USB Cable\*1             | Tank Robot Chassis \*1                                |
| ![](/media/686670898705c411f9affbd3e2e78c61.png)                             |

**(4) The principle of ultrasonic sensor**

As the above picture shown, it is like two eyes. One is transmitting
end, the other is receiving end.

The ultrasonic module will emit the ultrasonic waves after triggering a
signal. When the ultrasonic waves encounter the object and are reflected
back, the module outputs an echo signal, so it can determine the
distance of the object from the time difference between the trigger
signal and echo signal.

The t is the time that emitting signal meets obstacle and returns. And
the propagation speed of sound in the air is about 343m/s, and distance
= speed \* time. However, the ultrasonic wave emits and comes back,
which is 2 times of distance. Therefore, it needs to be divided by 2,
the distance measured by ultrasonic wave = (speed \* time)/2

1.  Use method and timing chart of ultrasonic module:

2.  Setting the delay time of Trig pin of SR04 to 10μs at least, which
    can trigger it to detect distance.

3.  2\. After triggering, the module will automatically send eight 40KHz
    ultrasonic pulses and detect whether there is a signal return. This
    step will be completed automatically by the module.

4.  3\. If the signal returns, the Echo pin will output a high level,
    and the duration of the high level is the time from the transmission
    of the ultrasonic wave to the return.

|                          |
| ------------------------ |
| ![](/media/ba43be6007d9fe3aab0bb609868af640.png) |

Circuit diagram of ultrasonic sensor:

![](/media/a25028af84d6c7c94382c2a907101241.jpeg)

5)  **Connection Diagram：**

![](/media/a5bdd6bb9bbe9db82c93e9193cbac4cd.png)

Note: The pin VCC, Trig, Echo and Gnd of the ultrasonic sensor are
respectively connected to 5v(V), 12(S), 13(S) and Gnd(G) of the shield

6)  Test Code：

/\*

keyestudio Mini Tank Robot V3

lesson 8.1

Ultrasonic sensor

http:/www.keyestudio.com

\*/

int trigPin = 12; / Pin Trig attach to 12

int echoPin = 13; / Pin Echo attach to 13

long duration, cm, inches;

void setup() 

void loop() 

7)  Test Results：

Upload test code on the development board, open serial monitor and set
baud rate to 9600. The detected distance will be displayed, and the unit
is cm and inch. Hinder the ultrasonic sensor by hand, the displayed
distance value gets smaller.

![](/media/2ff018e5d9d631a32fce99eb9b4778be.png)

8)  Code Explanation:

**int trigPin-** this pin is defined to transmit ultrasonic waves,
generally output.

**int echoPin -** this is defined as the pin of reception, generally
input

**cm = (duration/2) / 29.1-unit is cm**

**inches = (duration/2) / 74-unit is inch**

We can calculate the distance by using the following formula:

distance = (traveltime/2) x speed of sound

The speed of sound is: 343m/s = 0.0343 cm/uS = 1/29.1 cm/uS

Or in inches: 13503.9in/s = 0.0135in/uS = 1/74in/uS

We need to divide the traveltime by 2 because we have to take into
account that the wave was sent, hit the object, and then returned back
to the sensor.

9)  Extension Practice:

We have just measured the distance displayed by the ultrasonic. How
about controlling the LED with the measured distance? Let's try it and
connect an LED light module to the D3 pin.

![](/media/21d1810a3bf0827d6097188051f61867.png)

/\*

keyestudio Mini Tank Robot V3

lesson 8.2

Ultrasonic LED

http:/www.keyestudio.com

\*/

int trigPin = 12; / Pin Trig attach to 12

int echoPin = 13; / Pin Echo attach to 13

int LED = 3;

long duration, cm, inches;

void setup() 

void loop()  else 

delay(50);

}

Upload test code to development board and block ultrasonic sensor by
hand, then check if LED is on.

**Project 9: IR Reception**

1)  Description：
    
    ![](/media/8969111328604c5358f7c915ac94e474.png)
    
    There is no doubt that infrared remote control is ubiquitous in
    daily life. It is used to control various household appliances, such
    as TVs, stereos, video recorders and satellite signal receivers.
    Infrared remote control is composed of infrared transmitting and
    infrared receiving systems, that is, an infrared remote control and
    infrared receiving module and a single-chip microcomputer capable of
    decoding.​    

The 38K infrared carrier signal emitted by remote controller is encoded
by the encoding chip in the remote controller. It is composed of a
section of pilot code, user code, user inverse code, data code, and data
inverse code. The time interval of the pulse is used to distinguish
whether it is a 0 or 1 signal and the encoding is made up of these 0, 1
signals.

The user code of the same remote control is unchanged while the data
code can distinguish the key.

When the remote control button is pressed, the remote control sends out
an infrared carrier signal. When the IR receiver receives the signal,
the program will decode the carrier signal and determines which key is
pressed. The MCU decodes the received 01 signal, thereby judging what
key is pressed by the remote control.

Infrared receiver we use is an infrared receiver module. Mainly composed
of an infrared receiver head, which is a device that integrates
reception, amplification, and demodulation. Its internal IC has
completed demodulation, and can achieve from infrared reception to
output and be compatible with TTL signals. Additionally, it is suitable
for infrared remote control and infrared data transmission. The infrared
receiving module made by the receiver has only three pins, signal line,
VCC and GND. It is very convenient to communicate with Arduino and other
microcontrollers.

2)  Parameters:

![](/media/3434d75335432418ecff2bd64df180bd.png)

Operating Voltage: 3.3-5V（DC）

Interface: 3PIN

Output Signal: Digital signal

Receiving Angle: 90 degrees

Frequency: 38khz

Receiving Distance: 10m

(3) Components Needed:

|                                       |                                                     |                          |                                                       |
| ------------------------------------- | --------------------------------------------------- | ------------------------ | ----------------------------------------------------- |
| Keyestudio V4.0 Development Board \*1 | L298P Motor Driver Shield\*1                        | Yellow LED Module\*1     | 3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black)\*1 |
| ![](/media/6a1c8e7c27ca08c62ac0c30a0dbd4578.png)                              |
| IR Receiver Module \*1                | 3P-3P XH2.54 to PH2.0 Dupont Wire（Yellow-Red-Black) | USB Cable                | Tank Robot Chassis \*1                                |
| ![](/media/686670898705c411f9affbd3e2e78c61.png)                             |

(4) Connection Diagram：

![](/media/13872c10e2dc6889da0b4203785bd67a.png)

Note: the pin “-”,“+”and S of the IR receiver are respectively connected
to pin G（GND）, V（VCC）and A2 of the sensor expansion board. On the
condition that digital ports are not enough, the analog ports also can
be served as digital ports. A0 is equal to the digital port 14, A1 means
the digital port15.

5)  Test Code：

**Before uploading the following code, import the library of IR receiver
module.**

/\*

keyestudio Mini Tank Robot V3

lesson 9.1

IRremote

http:/www.keyestudio.com

\*/

\#include \<IRremote.h\> /IRremote library statement

int RECV\_PIN = A2; /define the pin of IR receiver as A2

IRrecv irrecv(RECV\_PIN);

decode\_results results; /decoding results are saved in the result

void setup() 

void loop() 

delay(100);

}

6)  Test Results：
    
    Upload test code, open serial monitor and set baud rate to 9600,
    point remote control to IR receiver. Then the corresponding value
    will be shown. If holding down keys for a while, the error codes
    will appear.
    
    ![](/media/a484b81d031c8d6e8addb169136fd45c.png)

Below we have listed out each key value of keyestudio remote control. So
you can keep it for reference.

> ![](/media/ebcf0cb2055f7784505f76ceeaef9f47.jpeg)

7)  Code Explanation:

**irrecv.enableIRIn():** after enabling IR decoding, the IR signals will
be received, then function“decode()”will check continuously if decode
successfully.

**irrecv.decode(\&results):** after decoding successfully, this function
will come back to “true”, and keep result in “results”. After decoding a
IR signals, run the resume()function and receive the next signal.

8)  Extension Practice:

We decoded the key value of IR remote control. How about controlling LED
by the measured value? We could design an experiment.

Attach an LED to D3, then press the keys of remote control to make LED
light on and off.

![](/media/b45e9c7113751b5ab953ff7e0b0750df.png)

/\*

keyestudio Mini Tank Robot V3

lesson 9.2

IRremote

http:/www.keyestudio.com

\*/

\#include \<IRremote.h\> /IRremote library statement

int RECV\_PIN = A2; /define the pin of the IR receiver as A2

int LED = 3;

bool flag = 0;

IRrecv irrecv(RECV\_PIN);

decode\_results results; /

void setup() 

void loop() 

else if (results.value == 0xFF02FD & flag == 1) /press again



irrecv.resume(); / receive next value

}

}

Upload code to development board, press the“OK”key on remote control to
make LED on and off.

**Project 10: Bluetooth Remote Control**

**(1)Description:**

In the last several decades, Bluetooth has become the most popular
wireless communication module for it is easy to use and has found wide
applications in most devices powered by batteries.

In order to adjust with the time and reality and need the needs of
customers, Bluetooth has been upgraded several times. In recent years,
it embraces lots of transformations in terms of data transfer rate,
power consumption of wearable devices and IoT devices, and security
systems and others. Here, we plan to learn about HM-10 BLE 4.0 with
Arduino board.

HM-10,a 4.0 Bluetooth module, can serves as a platform for wireless data
communication at any time. This module is designed using Texas
Instruments (TI) CC2540 or CC2541 Bluetooth Low Energy (BLE)
System-on-Chip (SoC).

(2）Parameters：

1\. Bluetooth protocol: Bluetooth Specification V4.0 BLE

2\. No byte limit in serial port Transceiving

3\. In open environment, realize 100m ultra-distance communication with
iphone4s

4\. USB protocol: USB V2.0

5\. Working frequency: 2.4GHz ISM band

6\. Modulation method: GFSK(Gaussian Frequency Shift Keying)

7\. Transmission power: -23dbm, -6dbm, 0dbm, 6dbm, can be modified by AT
command.

8\. Sensitivity: ≤-84dBm at 0.1% BER

9\. Transmission rate: Asynchronous: 6K bytes

Synchronous: 6k Bytes

10\. Security feature: Authentication and encryption

11\. Supporting service: Central & Peripheral UUID FFE0, FFE1

12\. Power consumption: Auto sleep mode, stand by current 400uA\~800uA,
8.5mA during transmission.

13\. Power supply: 5V DC

14\. Working temperature: –5 \~ +65 Centigrade

**(3)Components Needed:**

|                                       |                                      |                          |                                                    |
| ------------------------------------- | ------------------------------------ | ------------------------ | -------------------------------------------------- |
| Keyestudio V4.0 Development Board \*1 | Keyestudio L298P Motor Driver Shield | Yellow LED Module\*1     | 3P-3P XH2.54 to 2.54 Dupont Wire（Yellow-Red-Black) |
| ![](/media/ecbffcb36ad26a65fbc86a13a14739ec.png)                          |
| Keyestudio HM-10 BT-4.0 Module\*1     | USB Cable\*1                         |                          |                                                    |
| ![](/media/4f8d5af6dee9016b45d975adb2391d37.png)              |                          |                                                    |

4)  **Connection Diagram:**

1.STATE is the status test pin connected to the internal light-emitting
diode and usually remains unconnected.

2.RXD is the serial port interface for receiving terminal.

3.TXD is the serial port interface for sending terminal.

4.GND is for ground.

5.VCC is the positive pole.

6.EN/BRK: the disconnection of it represents the disconnection of the
Bluetooth and it usually remains unconnected.

(Note: here the Bluetooth is directly linked with the V2 shield and
please pay attention to the direction)

![](/media/5fad63a7f6b9cacc9fcf71cbf83c58f3.png)

**(5)Test Code**

/\*

keyestudio Mini Tank Robot V3

lesson 10.1

Bluetooth

http:/www.keyestudio.com

\*/

char ble\_val; /Character variable(used to store the value received by
Bluetooth)

void setup() 

void loop() 

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

(Note: Do not connect the Bluetooth module before uploading the code,
because the uploading of the code also uses serial communication, and
there may be conflicts with the serial communication of the Bluetooth,
which can cause the uploading of the code to fail.)

Upload the code to the development board, then plug in the Bluetooth
module, and then wait for the instructions from the mobile phone.

**(6)Download Bluetooth APP:**

The above code is for reading the signals received by the serial port.
Then a device used to send out signals is required. In this project,
this device is a smart phone. The phone transmits signals and the
Bluetooth receives these signals and prints them on the serial port of
the development board. And we also need to download an App on our
phones.

**1.Download instructions for Apple system:**

Go to APP STORE→search for BLE Scanner 4.0→download it to your phone.

![](/media/17adf8dc7318b8104373f0d518398279.png)

**2.Download instructions for Android system:**

Go to [Google
Play](https:/developer.android.google.cn/distribute?hl=zh-cn)→search
for BLE Scanner 4.0→download it to your phone.

![](/media/cf5e6cd8b98346d3e90faf4a10e92dc1.png)

3.After the installation is complete, open the app and enable the
"Location and Bluetooth" permission

4.  The usage of this App is almost the same for Apple system and
    Android system. And here we intend to take Apple system as an
    example to explain how to use it properly.

5.Scan for Bluetooth devices and the name of Bluetooth BLE 4.0 is HMSoft
which does not have a pairing password. Therefore, click connect to
connect to HMSoft and then you can start using it.

![](/media/cc2ad4236eb001676ae447e8033edd2f.png)

6.After the pairing, click it, and you will get many options, such as
device information, general access rights, general attributes, custom
services and others. Among all these options, select "Customize
Service".

![](/media/af36b3e8e815a539c07c18738ee5366f.png)

7.Then the following page pops up.

![](/media/f74e64f9f29e0813db44971d2896d7f2.png)

8.Click words（Read,Notify,WriteWithoutResponse) in blue to enter the
following page.

![](/media/c769ffa7b68eb36516a429147d5f65b6.png)

9.Tap Write Value and the page HEX or Tex appears as shown in the figure
below.

![](/media/d8afcda78947d9fc25d41cc16a182369.png)

10. Open the serial port monitor of Arduino and input a 0 or other
    character.

![](/media/767ed0b7d1876e63ff109d8a355209ac.png)

11. Click Write and open serial port monitor to confirm whether it the
    signal 0 or other character is received.

![](/media/5254b35b30451fc6dbf7de998cf5e16b.png)（()7）代码说明:

7)  **Code Explanation**
    
    **Serial.available()** represents the number of characters currently
    remaining in the serial port buffer. This function is generally used
    to determine whether there is data in this area. When
    Serial.available()\>0, it means that the serial port has received
    data and can be read.

**Serial.read()** refers to taking out and reading a Byte of data from
the serial port buffer. For example, if a device sends data to the
Arduino through the serial port, we can use Serial.read() to read the
sent data.

()()

**(8)Expansion Project**

In the above project, we have explained that the Bluetooth receives the
signal sent by the mobile phone and displayed it on the serial port of
the development board. Now let’s think about a question that can we use
the received signal to do something else? The answer is positive. Here
we plans to use the command sent by the mobile phone to turn on or off
an LED. From the wiring diagram, we can find that an LED is connected to
pin D3.

![](/media/46adc3fdd061772e09a977db42b7e5d8.png)

/\*

keyestudio Mini Tank Robot V3

lesson 10.2

Bluetooth

http:/www.keyestudio.com

\*/

int LED = 3;

int ble\_val; /Integer variable(used to store the value received by
Bluetooth)

void setup() 

void loop() 

if (ble\_val == '0') 

}

}

![](/media/767ed0b7d1876e63ff109d8a355209ac.png)

Click Write on the mobile APP and send 1 or 0 to control the LED. When
you send “1”, the LED is on, and when you send“0”, the LED is off.
(After the Bluetooth project is completed, unplug it from the
development board, so as not to affect the subsequent code burning
process)

## 

**Project 11: Motor Driving and Speed Control**

**(1)Description:**

()（1）项目介绍：

There are many ways to drive motors. Our smart car uses the most common
solution called L298P. L298P, produced by STMicroelectronics, is an
excellent driving chip specially designed for driving high-power motors
. It can directly drive DC motors, two-phase and four-phase motors with
the driving current reaching 2A. And the motor’s output terminal adopts
8 high-speed Schottky diodes as protection. We have designed an
expansion board based on the L298P circuit of which the laminated design
can be directly plugged into the UNO R3 board for use reducing the
technical difficulties for users in using and driving the motor.

Stack the expansion board on the board, power the BAT , turn the DIP
switch to the ON end, and power the expansion board and the UNO R3 board
at the same time via external power supply. In order to facilitate
wiring, the expansion board is equipped with anti-reverse interface
(PH2.0 -2P -3P -4P -5P) and thus it can be directly plug with motors,
power supply, and sensors /modules. The Bluetooth interface of the drive
expansion board is fully compatible with the Keyestudio HM-10 Bluetooth
module. Therefore, we only need to insert the HM-10 Bluetooth module
into the corresponding interface when connecting. At the same time, the
drive extension board also uses 2.54 pin headers to extend out some
available digital ports and analog ports, so that you can continue to
add other sensors and carry out expansion experiments.

The expansion board can be connected to 4 DC motors. In the default
jumper cap connection mode, the A and A1, B and B1 interface motors are
connected in parallel, and their motion pattern is the same. 8 jumper
caps can be used to control the rotation direction of the 4 motor
interfaces. For example, when the two jumper caps in front of the motor
A interface are changed from a horizontal connection to a vertical
connection, the rotation direction of the motor A now is opposite to the
original rotation direction.

**(2)Circuit**

![](/media/6c3731f639e113c8f32fe1829f239898.png)

(2）Parameters：

  - Logic part input voltage: DC 5V

  - Driving part input voltage: DC 7-12V

  - Logic part working current: ≤36mA

  - Driving part working current: ≤ 2A

  - Maximum dissipation power: 25W (T=75℃)

  - Control signal input level:
    
    High level: 2.3V ≤ Vin ≤ 5V
    
    Low level: 0V ≤ Vin ≤ 1.5V

  - Working temperature: -25℃～＋130℃
    
    **(4)Drive the robot to move**
    
    From the circuit above, it is known that for motor A D4 is its
    direction pin and D5 the speed pin while for motor B D2 is its
    direction pin and D8 the speed pin.

According to the table below, we can know how to control the movement of
the robot by controlling the rotation of two motors through the digital
ports and PWM ports . Among them, the range of PWM value is 0-255. The
larger the value is, the faster the motor rotates.

|              |      |         |                      |      |         |                      |
| ------------ | ---- | ------- | -------------------- | ---- | ------- | -------------------- |
| Movements    | D4   | D5（PWM） | Motor（on the left）   | D2   | D9（PWM） | Motor（on the right）  |
| Move Forward | LOW  | 200     | Rotate Clockwise     | LOW  | 200     | Rotate Clockwise     |
| Go Back      | HIGH | 200     | Rotate Anticlockwise | HIGH | 200     | Rotate Anticlockwise |
| Rotate Left  | HIGH | 200     | Rotate Anticlockwise | LOW  | 200     | Rotate Clockwise     |
| Rotate Right | LOW  | 200     | Rotate Clockwise     | HIGH | 200     | Rotate Anticlockwise |
| Stop         | /    | 0       | Stop                 | /    | 0       | Stop                 |

**(5)Components Needed:**

()90()（4）项目组件：

|                                       |                                      |                           |                         |
| ------------------------------------- | ------------------------------------ | ------------------------- | ----------------------- |
| Keyestudio V4.0 Development Board \*1 | Keyestudio L298P Motor Driver Shield | Tank Robot Chassis        | USB Cable\*1            |
| ![](/media/4f8d5af6dee9016b45d975adb2391d37.png) |

**(6)Connection Diagram:**

**()（5）接线图：**

![](/media/240537c0722089b5846b312dd9708ff9.png)

Note:

There is a silk screen 1234 on the front of the 4pin connector. One of
the two motors should be connected with pin A (marked as the right
one)and the other with pin B(marked as the left one).

**(7)Test Code**

/\*

keyestudio Mini Tank Robot V3

lesson 11.1

motor driver

http:/www.keyestudio.com

\*/

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

void setup()



void loop()



/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

(）项目结果：

8)  **Test Results:**

After wiring according to the diagram, uploading the test code and
powering it up, the smart car moves forward for 2s, steps back for 2s,
turns left for 2s, turns right for 2s and stops for 2s and repeats this
sequence.

()()

9)  **Code Explanation**

**digitalWrite(ML\_Ctrl,LOW);**

The change between high and low levels can makes motors to rotate
clockwise or anticlockwise. General digital pins can be used to control
these movements.

**analogWrite(ML\_PWM,200);**

The speed adjustment of the motor is realized by PWM, and the pin that
controls the speed of the motor must be the PWM pin of Arduino.

项目拓展：

**(10)Expansion Project:**

We adjust the speed of motors by controlling PWM and the wiring remains
the same.

/\*

keyestudio Mini Tank Robot V3

lesson 11.2

motor driver pwm

http:/www.keyestudio.com

\*/

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

void setup() 

void loop() 

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Note: if the battery power is too low, the motors could move in a low
speed and fail to turn around.

**Project 12: 8\*16 Facial Expression LED Dot Matrix**

**(1)Description:**

Won’t it be fun if a expression board is added to the robot? And the
Keyestudio 8\*16 LED dot matrix can do the trick. With the help of it,
you could design facial expressions, images, patterns and other displays
by yourselves.

The 8\*16 LED board comes with 128 LEDs. The data of the microprocessor
(Arduino) communicates with the AiP1640 through a two-wire bus
interface. Therefore, it can control the on and off of 128 LEDs on the
module, so as to make the dot matrix on the module to display the
pattern you need. A HX-2.54 4Pin cable is provided for your convenience
of wiring.

(2）Parameters：

  - Working voltage: DC 3.3-5V

  - Power loss: 400mW

  - Oscillation frequency: 450KHz

  - Drive current: 200mA

  - Working temperature: -40\~80℃

  - Communication mode: two-wire bus
    
    **(3)Components Needed:**

（3）项目组件：

<table>
<tbody>
<tr class="odd">
<td>Keyestudio V4.0 Development Board *1</td>
<td><p>Keyestudio L298P Motor </p>
<p>Driver Shield*1</p></td>
<td>keyestudio 8x16 LED Dot Matrix*1</td>
<td>4P HX-2.54 Dupont Wire (Black-Red-White-Brown)</td>
</tr>
<tr class="even">
<td><img src="/media/8ecfc7e4f74bd2001452e33f74eace2e.png" style="width:1.38056in;height:0.99722in" /></td>
<td><img src="/media/4ebdedd20a23f95ce5ae9c0a4d124a81.png" style="width:1.45833in;height:1.17153in" /></td>
<td><img src="/media/08dcdaab2f13bc2e539e1b672f730196.png" style="width:1.20972in;height:0.55556in" /></td>
<td><img src="/media/2b70dfddb2057cbfc54ecb8666c64aeb.png" style="width:1.65556in;height:0.37222in" /></td>
</tr>
<tr class="odd">
<td>USB cable*1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/4f8d5af6dee9016b45d975adb2391d37.png" style="width:1.38611in;height:0.5125in" /></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

**(4)About the 8\*16 Dot Matrix**

**Circuit of the 8\*16 LED dot matrix**

![](/media/edf6c77d05904eebbaa89d557e9e9c1a.png)

**Principle of the 8\*16 LED dot matrix**

How to control each LED of the 8\*16 dot matrix? It is known that each
byte has 8 bits and each bit is 0 or 1. when it is 0, LED is off while
when it is 1 LED is on. One byte can control one column of the LED,and
naturally 16 bytes can control 16 columns of LEDs, that’s the 8\*16 dot
matrix.

**Pins description and communication protocol**

The data of the microprocessor (Arduino) communicates with the AiP1640
through a two-wire bus cable.

The communication protocol diagram is as follows (SCLK) is SCL, (DIN) is
SDA

![](/media/ea2bab37f23c09453c680590b84653d6.png)

①The starting condition for data input: SCL is high level and SDA
changes from high to low.

②For data command setting, there are methods as shown in the figure
below

In our sample program, select the way to **add 1 to the address
automatically**, the binary value is 0100 0000 and the corresponding
hexadecimal value is 0x40

|                          |
| ------------------------ |
| ![](/media/7e326d7edc877ea2509cbf8649f82d99.png) |

③For address command setting, the address can be selected as shown
below.

The first 00H is selected in our sample program, and the binary number
1100 0000 corresponds to the hexadecimal 0xc0

|                          |
| ------------------------ |
| ![](/media/e6da87c9f6056f849c973edec5456f3e.png) |

④The requirement for data input is that when SCL is at high level when
inputting data, the signal on SDA must remain unchanged. Only when the
clock signal on SCL is at low level, can the signal on SDA be changed.
The input of data is the low bit first, and the high bit later.

⑤The condition for the end of data transmission is that when SCL is at
low level, SDA at low level and SCL at high level, the level of SDA
becomes high.

⑥Display control, set different pulse width, pulse width can be selected
as shown in the figure below

In the example, the pulse width is 4/16, and the hexadecimal
corresponding to 1000 1010 is 0x8A

|                          |
| ------------------------ |
| ![](/media/ad238f413988f77bcf074a5642a5061d.png) |

4\. Instructions for the use of modulus tool

The dot matrix tool uses the online version, and the link is :
http:/dotmatrixtool.com/\#

①Enter the link and the page appears as shown below

![](/media/354693b5679a2615c62e99b7025d6355.png)

②The dot matrix is 8\*16, so adjust the height to 8 and width to 16, as
shown in the figure below

![](/media/5f0278d66ade370e871b447d360d6e7b.png)

③Generate hexadecimal data from the pattern

As shown in the figure below, press the left mouse button to select,
right click to cancel; draw the pattern you want, click Generate, and
the hexadecimal data we need will be generated.

![](/media/586e88bf13c61b0918046437ed7f6796.png)

**(5)Connection Diagram:**

）接线图：

![](/media/e99e28c46c8c40cc5133105783e5fe5d.png)

The GND, VCC, SDA, and SCL of the 8x16 LED light board are respectively
connected to the keyestudio sensor expansion board-(GND), + (VCC), A4,
A5 for two-wire serial communication.

(Note: though it is connected with the IIC pin of Arduino, this module
is not for IIC communication. And the IO port here is to simulate I2C
communication and can be connected with any two pins )

**(6)Test Code**

）项目代码

/\*

keyestudio Mini Tank Robot V3

lesson 12.1

Matrix face

http:/www.keyestudio.com

\*/

/get the data of smile image from a modulus tool

unsigned char smile\[\] = ;

\#define SCL\_Pin A5 /set a pin of clock to A5

\#define SDA\_Pin A4 /set a data pin to A4

void setup() 

void loop() 

/this function is used for the display of dot matrix

void matrix\_display(unsigned char matrix\_value\[\])



IIC\_end(); /end the data transmission of pictures

IIC\_start();

IIC\_send(0x8A); /show control and select pulse width 4/16

IIC\_end();

}

/the condition that data starts transmitting

void IIC\_start()



/the sign that transmission of data ends

void IIC\_end()



/transmit data

void IIC\_send(unsigned char send\_data)

 else 

delayMicroseconds(3);

digitalWrite(SCL\_Pin, HIGH); /pull up the clock pin SCL\_Pin to end
the transmission of data

delayMicroseconds(3);

digitalWrite(SCL\_Pin, LOW); /pull down the clock pin SCL\_Pin to
change signals of SDA

}

}(（()

()7项目结果：

**(7 )Test Results:**

After uploading the test code successfully, connecting according to the
wiring diagram, dialing the DIP switch to the right end and powering it
on, a smile-shaped pattern shows on the dot matrix.

> ![](/media/0fd4831db288e04e75828346ea66a3f5.png)

**(8)Expansion Project:**

We use the modulus tool we just learned, http:/dotmatrixtool.com/\#, to
make the dot matrix display the pattern start , going forward, and stop
and then clear the pattern. The time interval is 2000 ms.

|                          |                          |                          |
| ------------------------ | ------------------------ | ------------------------ |
| ![](/media/b0a961f27eb5f0b66603abe23d6bb56a.png) |

**Code obtained from the module tool：**

**Code for** **the pattern start:**

0x01,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x80,0x40,0x20,0x10,0x08,0x04,0x02,0x01

**Code for the pattern going forward:**

0x00,0x00,0x00,0x00,0x00,0x24,0x12,0x09,0x12,0x24,0x00,0x00,0x00,0x00,0x00,0x00

**Code for the pattern stepping back:**

0x00,0x00,0x00,0x00,0x00,0x24,0x48,0x90,0x48,0x24,0x00,0x00,0x00,0x00,0x00,0x00

**Code for the pattern turning left：**

0x00,0x00,0x00,0x00,0x00,0x00,0x44,0x28,0x10,0x44,0x28,0x10,0x44,0x28,0x10,0x00

**Code for the pattern turning right：**

0x00,0x10,0x28,0x44,0x10,0x28,0x44,0x10,0x28,0x44,0x00,0x00,0x00,0x00,0x00,0x00

**Code for the pattern stop：**

0x2E,0x2A,0x3A,0x00,0x02,0x3E,0x02,0x00,0x3E,0x22,0x3E,0x00,0x3E,0x0A,0x0E,0x00

**Code to clear screen：**

0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00

**Complete code:**

/\*

keyestudio Mini Tank Robot V3

lesson 12.2

Matrix face

http:/www.keyestudio.com

\*/

/Array, used to save data of images, can be calculated by yourself or
gotten from modulus tool

unsigned char start01\[\] = ;

unsigned char front\[\] = ;

unsigned char back\[\] = ;

unsigned char left\[\] = ;

unsigned char right\[\] = ;

unsigned char STOP01\[\] = ;

unsigned char clear\[\] = ;

\#define SCL\_Pin A5 /set a pin of clock to A5

\#define SDA\_Pin A4 /set a data pin to A4

void setup() 

void loop() 

/this function is used for the display of dot matrix

void matrix\_display(unsigned char matrix\_value\[\])



IIC\_end(); /end the data transmission of pictures

IIC\_start();

IIC\_send(0x8A); /show control and select pulse width 4/16

IIC\_end();

}

/the condition that data starts transmitting

void IIC\_start()



/the sign that transmission of data ends

void IIC\_end()



/transmit data

void IIC\_send(unsigned char send\_data)

 else 

delayMicroseconds(3);

digitalWrite(SCL\_Pin, HIGH); /pull up the clock pin SCL\_Pin to end
the transmission of data

delayMicroseconds(3);

digitalWrite(SCL\_Pin, LOW); /pull down the clock pin SCL\_Pin to
change signals of SDA

}

}

After uploading test code,the facial expression board shows these
patterns orderly and repeats this sequence.

|                          |                          |                          |
| ------------------------ | ------------------------ | ------------------------ |
| ![](/media/e269e060c9a0dd4311ea34e8333c297e.png) |

**Project 13: Light-following Tank**

![](/media/ecf3b259b6bce18922959388dc4a8466.jpeg)

**(1)Description**:

（1）项目介绍：

In previous projects, we introduced in detail the use of various
sensors, modules, and expansion boards on the smart car. Now let’s move
to the projects of the smart car . The light-following smart cars, as
the name suggests, is a smart car that can follow the light.

We can combine the knowledge from projects photoresistor and motor drive
to make a light-seeking smart car. In the project, we use two
photoresistor modules to detect the light intensity on the left and
right sides of the smart car, read the corresponding analog values, and
then control the rotation of the two motors based on these two data so
as,to control the movements of the smart car.

The specific logic of the light-following smart car is shown as below.

|                                                             |                                      |              |
| ----------------------------------------------------------- | ------------------------------------ | ------------ |
| Detection (the bigger the brightness,the bigger the value ) | photoresistor module on the left     | left\_light  |
|                                                             | photoresistor module on the right    | right\_light |
| Condition                                                   | left\_light＞650 and right\_light＞650 |              |
| Movement                                                    | Move forward（set PWM to 200）         |              |
| Condition                                                   | left\_light＞650 and right\_light≤650 |              |
| Movement                                                    | Rotate left（set PWM to 200）          |              |
| Condition                                                   | left\_light≤650 and right\_light＞650 |              |
| Movement                                                    | Rotate right（set PWM to 200）         |              |
| Condition                                                   | left\_light≤650 and right\_light≤650 |              |
| Movement                                                    | stop                                 |              |

**(2)Flow chart**

**(3)Connection Diagram:**

3）接线图

![](/media/210342dc6ecc994c26f2a1bca0df58b1.png)

Note: The "-", "+" and S pins of the photoresistor module on the left
are connected to G (GND), V (VCC), A0 respectively;

the "-", "+" and S pins of the photoresistor module on the right are
connected to the G (GND), V (VCC), and A1 respectively.

There is a silk screen 1234 on the front of the 4pin cable. The red wire
of the rear right motor is connected to 1, the black wire is connected
to 2, the black wire of the front left motor is connected to 4, and the
red wire is connected to 3.

（4）测试代码：

**(4)Test Code**

/\*

keyestudio Mini Tank Robot V3

lesson 13

light follow tank

http:/www.keyestudio.com

\*/

\#define light\_L\_Pin A0 /Define the pin of the photosensitive sensor
on the left

\#define light\_R\_Pin A1 /Define the pin of the photosensitive sensor
on the right

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

int left\_light;

int right\_light;

void setup() 

void loop() 

else if (left\_light \> 650 && right\_light \<= 650) /Range value
detected by the photosensitive sensor,turn left



else if (left\_light \<= 650 && right\_light \> 650) /Range value
detected by the photosensitive sensor,turn right



else /In other conditions stop



}

void Car\_front()



void Car\_left()



void Car\_right()



void Car\_Stop()



/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(5 )Test Results:**

After uploading the test code successfully, connecting according to the
wiring diagram, dialing the DIP switch to the right end and powering it
on, the smart car follows the light to move.（5）测试结果

**Project 14: Ultrasonic Sound-following Tank**

![](/media/26de2c574af94f92874749054eacf3e9.jpeg)

**(1)Description:**

（1）项目介绍

In the previous lesson, we learned about the light-following smart car.
And in this lesson, we can combine the knowledge to make an ultrasonic
sound-following car. In the project, we use ultrasonic sensors to detect
the distance between the car and the obstacle in front, and then control
the rotation of the two motors based on this data so as to control the
movements of the smart car.

The specific logic of the ultrasonic sound- following smart car is shown
in the table below:

<table>
<tbody>
<tr class="odd">
<td>Detection</td>
<td>The distance between the car and the obstacle front</td>
<td><p>Distance</p>
<p>（unit：cm）</p></td>
</tr>
<tr class="even">
<td>Setting</td>
<td>Set the angle of the servo to 90°</td>
<td></td>
</tr>
<tr class="odd">
<td>Condition</td>
<td>distance≥20 and distance≤60</td>
<td></td>
</tr>
<tr class="even">
<td>Movement</td>
<td>（set PWM to 200）</td>
<td></td>
</tr>
<tr class="odd">
<td>Condition</td>
<td>distance＞10 and distance＜20</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>distance＞60</td>
<td></td>
</tr>
<tr class="odd">
<td>Movement</td>
<td>Stop</td>
<td></td>
</tr>
<tr class="even">
<td>Condition</td>
<td>distance≤10</td>
<td></td>
</tr>
<tr class="odd">
<td>Movement</td>
<td>Move back（set PWM to 200）</td>
<td></td>
</tr>
</tbody>
</table>

**(2)Flow chart**

**(3)Connection Diagram:**

（3）接线图

![](/media/19d05faf06476538560c7cc0b18623b5.png)

**(4)Test Code**

4）测试代码：

/\*

keyestudio Mini Tank Robot V3

lesson 14

Ultrasonic follow tank

http:/www.keyestudio.com

\*/

\#define servoPin 10 /The pin of servo

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

\#define Trig 12

\#define Echo 13

float distance;

void setup() 

void loop() 

else if (distance \> 10 && distance \< 20) /The distance range to stop



else if (distance \<= 10) /The distance range to Move forward



else /In other conditions, it stops



}

void Car\_front()



void Car\_back()



void Car\_left()



void Car\_right()



void Car\_Stop()



/The function controls servos

void procedure(byte myangle) 

}

/The function controls ultrasonic sound

float checkdistance() 

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(5 )Test Results:**

After uploading the test code successfully, connecting according to the
wiring diagram, dialing the DIP switch to the right end, powering it on,
and setting the servo to 9°，the smart car moves with the obstacle.
）测试结果：

**Project 15: Ultrasonic Obstacle Avoidance Tank**

![](/media/7bdae4a3b3bd2c295d9ff61ca9bd792f.jpeg)

1)  **Description:**
    
    In the previous project, we made an ultrasonic sound-following smart
    car. In fact, using the same components and the same wiring method,
    we only need to change the test code to turn it into an ultrasonic
    obstacle avoidance smart car. This smart car can move with the
    movement of the human hands. We use ultrasonic sensors to detect the
    distance between the smart car and the obstacle in front, and then
    control the rotation of the two motors based on this data so as to
    control the movements of the smart car.

<table>
<tbody>
<tr class="odd">
<td>Detection</td>
<td><p>Distance measured by the ultrasonic senor between the car and the obstacle in front</p>
<p>（set the angle of the servo to 90°）</p></td>
<td><p>a</p>
<p>（unit：cm）</p></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><p>Distance measured by the ultrasonic senor between the car and the obstacle on the right</p>
<p>（set the angle of the servo to 20°）</p></td>
<td><p>a2</p>
<p>（unit：cm）</p></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td><p>Distance measured by the ultrasonic senor between the car and the obstacle on the left</p>
<p>（set the angle of the servo to 160°）</p></td>
<td><p>a1</p>
<p>（unit：cm）</p></td>
<td></td>
</tr>
<tr class="even">
<td>Setting</td>
<td>set the starting angle of the servo to 90°</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Condition 1</td>
<td>Movement</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>a＜20</td>
<td>Stop for 1000 ms；set the angle of the servo to 160°，read a1，delay in 500ms；set the angle of the servo to 20°，read a2，delay in 500ms.</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>Condition 2</td>
<td>Movement</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td><p>a1＜50</p>
<p>or</p>
<p>a2＜50</p></td>
<td>Compare a1 with a2</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>Condition 3</td>
<td>Movement</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>a1＞a2</td>
<td>Set the angle of the servo to 90°，rotate left for 500ms（set PWM to 255），and move forward（set PWM to 200）.</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>a1＜a2</td>
<td>Set the angle of the servo to 90°，rotate right for 500ms（set PWM to 255），and move forward（set PWM to 200）.</td>
</tr>
<tr class="even">
<td></td>
<td>Condition 2</td>
<td>Movement</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td><p>a1≥50</p>
<p>and</p>
<p>a2≥50</p></td>
<td>Random</td>
<td>set the angle of the servo to 90°，rotate left for 500ms（set PWM to 255），and move forward（set PWM to 200）.</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td>set the angle of the servo to 90°，rotate right for 500ms（set PWM to 255），and move forward（set PWM to 200）.</td>
</tr>
<tr class="odd">
<td>Condition 2</td>
<td>Movement</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>a≥20</td>
<td>move forward（set PWM to 200）</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

The specific logic of the ultrasonic obstacle avoidance smart car is
shown in the table below:

### **(2)Flow chart**

**(3)Connection Diagram:**

（3）接线图：

![](/media/2ba32b8e2038fbc344fea3c24c0105a3.png)

(Note: the “-”, “+” and S pins of the servo are respectively connected
to G (GND), V (VCC) and D10 of the expansion board；and for the
ultrasonic sensor,the VCC pin is connected to the 5v (V) ,the Trig pin
to digital 12 (S), the Echo pin to digital 13 (S), and the Gnd pin to
Gnd (G); the same as last project.）

**(4)Test Code**

）测试代码:

/\*

keyestudio Mini Tank Robot V3

lesson 15

Ultrasonic avoid tank

http:/www.keyestudio.com

\*/

\#define servoPin 10 /The pin of servo

int a, a1, a2;

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

\#define Trig 12

\#define Echo 13

float distance;

void setup() 

void loop()  else 

}

else 

}

void Car\_front()



void Car\_back()



void Car\_left()



void Car\_right()



void Car\_Stop()



/The function controls servos

void procedure(byte myangle) 

}

/The function controls ultrasonic sound

float checkdistance() 

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(5)Test Results:**

After upload the test code successfully, wire up, turn the DIP switch to
the ON end, and power up, the smart car moves forward and automatically
avoids obstacles.5）测

试结果

**Project 16: Move-in-Confined-Space Tank**

![](/media/b519c777b40a0de462f10814d4c3ca48.jpeg)

<table>
<tbody>
<tr class="odd">
<td>Detection</td>
<td>Line-tracking sensor in the middle</td>
<td>Black line detected: in high level</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>White line detected: in low level</td>
</tr>
<tr class="odd">
<td></td>
<td>Line-tracking sensor on the left</td>
<td>Black line detected: in high level</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>White line detected: in low level</td>
</tr>
<tr class="odd">
<td></td>
<td>Line-tracking sensor on the right</td>
<td>Black line detected: in high level</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>White line detected: in low level</td>
</tr>
<tr class="odd">
<td>Condition</td>
<td>Movement</td>
<td></td>
</tr>
<tr class="even">
<td>All the three line-tracking sensors detect no black lines</td>
<td>Move forward（set PWM to 200）</td>
<td></td>
</tr>
<tr class="odd">
<td>Any of the three line-tracking sensors detects black lines</td>
<td><p>Step back（set PWM to 200）</p>
<p>Then rotate left（set PWM to 200）</p></td>
<td></td>
</tr>
</tbody>
</table>

**(2)Flow chart**

**(3)Connection Diagram:**

（3）接线图

![](/media/aca72dc201de41ce9edd42c30ea4628d.png)

**(4)Test Code**

（4）测试代码

/\*

keyestudio Mini Tank Robot V3

lesson 16

draw a circle for tank

http:/www.keyestudio.com

\*/

/The wiring of line tracking sensor

\#define L\_pin 6 /On the left\#define M\_pin 7 /In the middle

\#define R\_pin 8 /On the right

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

int L\_val, M\_val, R\_val;

void setup()



void loop () 

else 

}

void Car\_front()



void Car\_back()



void Car\_left()



void Car\_right()



void Car\_Stop()



/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(5 )Test Results:**

After uploading the test code successfully and powering it up, the smart
car moves in a confined space, the circle drawn in black line.

）测试结果

**Project 17: Line-tracking Tank**

![](/media/f07697b638146afdcd6dea654f5d2137.jpeg)

**(1)Description:**

In 1）项目介绍：

The previous project has introduced how to confine the smart car to move
in a certain space. In this project, we could use the knowledge learned
before to make it a line-tracking smart car. In the experiment, we use
the line-tracking sensor to detect whether there is a black line around
the smart car, and then control the rotation of the two motors according
to the detection results, so as to make the smart car to move along the
black line.

The specific logic of the line-tracking smart car is shown in the table
blow:

|                                                           |                                                                                                      |                                    |
| --------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- | ---------------------------------- |
| Detection                                                 | Line-tracking sensor in the middle                                                                   | Black line detected: in high level |
|                                                           |                                                                                                      | White line detected: in low level  |
|                                                           | Line-tracking sensor on the left                                                                     | Black line detected: in high level |
|                                                           |                                                                                                      | White line detected: in low level  |
|                                                           | Line-tracking sensor on the right                                                                    | Black line detected: in high level |
|                                                           |                                                                                                      | White line detected: in low level  |
| Condition                                                 | Movement                                                                                             |                                    |
| Line-tracking sensor in the middle detects the black line | Line-tracking sensor on the left detects the black line and the one on the right detects white lines | Rotate left（set PWM to 200）        |
|                                                           | Line-tracking sensor on the left detects white lines and the one on the right detects the black line | Rotate right（set PWM to 200）       |
|                                                           | Both the left and right line-tracking sensors detect white lines                                     | Move forward                       |
|                                                           | Both the left and right line-tracking sensors detect the black line                                  |                                    |
| Line-tracking sensor in the middle detects white lines    | Line-tracking sensor on the left detects the black line and the one on the right detects white lines | Rotate left（set PWM to 200）        |
|                                                           | Line-tracking sensor on the left detects white lines and the one on the right detects the black line | Rotate right（set PWM to 200）       |
|                                                           | Both the left and right line-tracking sensors detect white lines                                     | Stop                               |
|                                                           | Both the left and right line-tracking sensors detect the black line                                  |                                    |

**(2)Flow chart**

（2）实现方法：

**(3)Connection Diagram:**

（3）接线图

![](/media/aca72dc201de41ce9edd42c30ea4628d.png)

Note: it is the same as last project.

**(4)Test Code**

）测试代码

/\*

keyestudio Mini Tank Robot V3

lesson 17

Line track tank

http:/www.keyestudio.com

\*/

/The wiring of line tracking sensor

\#define L\_pin 6 /On the left

\#define M\_pin 7 /In the middle

\#define R\_pin 8 /On the right

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

int L\_val, M\_val, R\_val;

void setup()



void loop () 

else if (L\_val == 0 && R\_val == 1) 

else 

}

else 

else if (L\_val == 0 && R\_val == 1) 

else 

}

}

/Move forward

void Car\_front()



/Turn back

void Car\_back()



/Turn left

void Car\_left()



/Turn right

void Car\_right()



/Stop

void Car\_Stop()



/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*.

**(5)Test Results:**

After uploading the test code successfully and powering it up, the smart
car moves along the black line.（5）测

试结果

**Project 18: Fire Extinguishing Tank**

![](/media/b407e190f2308dcdb0a1570795fe2b54.jpeg)

**(1)Description:**

T

The line-tracking function of the smart tank has been explained in the
previous project. And in this project we use the flame sensor to make a
fire extinguishing robot. When the car encounters flames, the motor of
the fan will rotate to blow out the fire. Of course, we need to replace
the ultrasonic sensor and two photoresistors with a fan module and flame
sensors first.

The specific logic of the line-tracking smart car is shown in the table
blow:

|                       |                       |                                   |               |              |                                              |
| --------------------- | --------------------- | --------------------------------- | ------------- | ------------ | -------------------------------------------- |
| Flame sensors         | Line-tracking sensors | The status of the car and the fan |               |              |                                              |
| On the left           | On the right          | On the left                       | In the middle | On the right | /                                            |
| The analog value ≥700 | The analog value≤700  | /                                 | /             | /            | Stop，turn on the fan                         |
| The analog value\>700 | The analog value\<700 | /                                 | /             | /            | Stop，turn on the fan                         |
| The analog value≤700  | The analog value\>700 | /                                 | /             | /            | Stop，turn on the fan                         |
| The analog value\>700 | The analog value\>700 | /                                 | /             | /            | Turn off the fan and continue following line |

**(2)Flow chart**

**(3)Connection Diagram:**

3）接线图

![](/media/3b350609c229a4d0da2489a2ea2614da.png)

Note: the GND, VCC, SDA, and SCL of the 8x16 LED dot matrix are
respectively connected to-(GND), + (VCC), SDA, SCL on the expansion
board of V5 ;

The "-", "+" and S pins of the infrared receiving sensor are
respectively connected to the G (GND), V (VCC), A0 of the expansion
board with wires. When the digital port is not enough, the analog port
can be used as a digital port, and analog port A0 is equivalent to
digital port 14, A1 is equivalent to digital port 15, and so on.

**(4)Test Code**

（4）测试代码

/\*

keyestudio Mini Tank Robot V3

lesson 18

Fire extinguishing tank

http:/www.keyestudio.com

\*/

/\*

keyestudio Mini Tank Robot V3

lesson 18

Fire extinguishing tank

http:/www.keyestudio.com

\*/

int flame\_L = A0; /Define the flame interface on the left as the
analog pin A0

int flame\_R = A1; /Define the flame interface on the right as the
analog pin A1

/The wiring of line tracking sensor

\#define L\_pin 6 /On the left

\#define M\_pin 7 /In the middle

\#define R\_pin 8 /On the right

/The pin of the servo 130

int INA = 12;

int INB = 13;

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

int L\_val, M\_val, R\_val, flame\_valL, flame\_valR;

void setup()



void loop ()  else 

else if (L\_val == 0 && R\_val == 1) 

else 

}

else 

else if (L\_val == 0 && R\_val == 1) 

else 

}

}

}

void fan\_stop() 

void fan\_begin() 

void Car\_front()



void Car\_back()



void Car\_left()



void Car\_right()



void Car\_Stop()



/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(5)Test Results:**

After uploading the test code successfully and powering it up, the smart
car puts out the fire when it detects flame and continues moving along
the black line.5PUYPUTS

）测试结果

**Project 19: IR Remote Control Tank**

![](/media/fe3319362c94d0bcf196e86b0de2b885.jpeg)

**(1)Description:**

Infrared remote control is one of the most common remote control found
applications in electric motors, electric fans, and many other household
appliances. In this project,we use the knowledge we learned before to
make an infrared remote control smart car.

In the 9th lesson, we have tested the corresponding key value of each
key of the infrared remote control. In the project, we can set the code
(key value) to make the corresponding button to control the movements of
the smart car, and display the movement patterns on the 8X16 LED dot
matrix.

The specific logic of the line-tracking smart car is shown in the table
blow:

<table>
<tbody>
<tr class="odd">
<td>Initial setting</td>
<td>Set the servo to 90°</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>8X16 LED dot matrix shows the pattern“V”</td>
<td></td>
</tr>
<tr class="odd">
<td>Ultrasonic key</td>
<td>Key value</td>
<td>Instructions from the key</td>
</tr>
<tr class="even">
<td>Key:<img src="/media/b11dc5ffa6cccebc6088e5d557d76daf.png" style="width:0.57292in;height:0.61458in" /></td>
<td><p>Key value:</p>
<p>FF629D</p></td>
<td>Move forward（PWM设为200）</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LED dot matrix displays the pattern going forward</td>
</tr>
<tr class="even">
<td>Key:<img src="/media/ae8110034aacb083151cfd882ee599ba.png" style="width:0.57292in;height:0.58333in" /></td>
<td><p>Key value:</p>
<p>FFA857</p></td>
<td>Turn back（set PWM to 200）</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LEDdot matrix displays the pattern turning back</td>
</tr>
<tr class="even">
<td>Key:<img src="/media/bce9cba2c6d2465fbcce570ad4210eba.png" style="width:0.5625in;height:0.58333in" /></td>
<td><p>Key value:</p>
<p>FF22DD</p></td>
<td>Turn left</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LED dot matrix displays the pattern turning left</td>
</tr>
<tr class="even">
<td>Key:<img src="/media/ad907a618af86f30d52986bbbd57ba76.png" style="width:0.5625in;height:0.57292in" /></td>
<td><p>Key value:</p>
<p>FFC23D</p></td>
<td>Turn right</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LED dot matrix displays the pattern turning right</td>
</tr>
<tr class="even">
<td>Key:<img src="/media/9716a4ed61a4064d2f47a7b73eccaf87.png" style="width:0.5625in;height:0.54167in" /></td>
<td><p>Key value:</p>
<p>FF02FD</p></td>
<td>Stop</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LED dot matrix displays the pattern“STOP”</td>
</tr>
<tr class="even">
<td>Key:<img src="/media/92499f5bf0b8a1e6ec85526b5293fbbf.png" style="width:0.55208in;height:0.54167in" /></td>
<td><p>Key value:</p>
<p>FF30CF</p></td>
<td>Rotate left（set PWM to 200）</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LED dot matrix displays the pattern turning left</td>
</tr>
<tr class="even">
<td><p>Key:</p>
<p><img src="/media/dcada1dd0e8a75bc9f041e039bb15755.png" style="width:0.53125in;height:0.55208in" /></p></td>
<td><p>Key value:</p>
<p>FF7A85</p></td>
<td>Rotate right（set PWM to 200）</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>8X16 LED dot matrix displays the pattern turning right</td>
</tr>
</tbody>
</table>

**(2)Flow chart**

2）实现方法：

**(3)Connection Diagram:**

3）接线图

![](/media/ee3f7a1cef270470f925c136d9e4e630.png)

Note: The GND, VCC, SDA, and SCL of the 8x16 LED dot matrix are
respectively connected to-(GND), + (VCC), SDA, SCL on the sensor
expansion board of V5.

The pins "-", "+" and S of the infrared receiving sensor module are
respectively connected to G (GND), V (VCC), and A0 of the Keyestudio
expansion board. When the digital port is not enough, the analog port
can be used as a digital port. And analog port A0 is equivalent to
digital port 14, A1 is equivalent to digital port 15, and so on.

**(4)Test Code**

（4）测试代码

/\*

keyestudio Mini Tank Robot V3

lesson 19

IR remote tank

http:/www.keyestudio.com

\*/

\#include \<IRremote.h\>

IRrecv irrecv(A2); /

decode\_results results;

long ir\_rec; /Used to store the received infrared values

/Array, used to save data of images, can be calculated by yourself or
gotten from modulus tool

unsigned char start01\[\] = ;

unsigned char front\[\] = ;

unsigned char back\[\] = ;

unsigned char left\[\] = ;

unsigned char right\[\] = ;

unsigned char STOP01\[\] = ;

unsigned char clear\[\] = ;

\#define SCL\_Pin A5 /Set the clock pin as A5

\#define SDA\_Pin A4 /Set the data pin as A4

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

void setup() 

void loop() ;

if (results.decode\_type \>= 1 && results.decode\_type \<= 13) 

Serial.print("IR TYPE:" + type + " ");

Serial.println(ir\_rec, HEX);

irrecv.resume();

}

switch (ir\_rec) 

}

/\*\*\*\*\*\*\*\*\*\*\*\*The function controls the rotation of the
servo\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Car\_front() 

void Car\_back() 

void Car\_left() 

void Car\_right() 

void Car\_Stop() 

void Car\_T\_left() 

void Car\_T\_right() 

/This function is used for dot matrix display

void matrix\_display(unsigned char matrix\_value\[\])



IIC\_end(); /End the transmission of pattern data

IIC\_start();

IIC\_send(0x8A); /Display control, choose 4/16 pulse width

IIC\_end();

}

/Conditions for the start of data transmission

void IIC\_start()



/The signal of the end of data transmission

void IIC\_end()



/Transmit data

void IIC\_send(unsigned char send\_data)

 else 

delayMicroseconds(3);

digitalWrite(SCL\_Pin, HIGH); /Pull up the clock pin SCL\_Pin to end
the transmission of data

delayMicroseconds(3);

digitalWrite(SCL\_Pin, LOW); /Pull down the clock pin SCL\_Pin to
change signals of SDA

}

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(5)Test Results:**

（5）测试结果

After uploading the test code successfully and powering it up, the smart
car can be controlled to move by IR remote control and the 8\*16 shows
the corresponding patterns of its movements.

## **Project 20: Bluetooth Control Tank**

![](/media/8472e049f0ac03340b68b64e7593d9a1.jpeg)

1)  **Description:**
    
    We have learned the basic knowledge of Bluetooth in the previous
    project . In this lesson, we will use Bluetooth to control the smart
    car. Since it involves Bluetooth, a sending end and a receiving end
    are needed. In the project, we use the mobile phone as the sender
    (master), and the smart car connected with the HM-10 Bluetooth
    module (slave) as the receiver.
    
    We have learned earlier that sending a bit can control LEDs. And the
    principle of controlling this robot car is the same.
    
    In order to better control the intelligent tank robot, we specially
    made an APP. In this lesson, we will read all the key value on this
    APP through code, and then introduce the exclusive APP of our tank
    robot.
    
    ）APP的下载安装与介绍：

**(2)About the APP KeyesRobot**

**Download instructions for Apple System**

Open App Store→search for KeyesRobot→download it to your phone.

![](/media/38b61289e05c2e37ee7e10890303f130.png)

Open the APP Motorhome →the following page pops up→select Tank Robot.

![](/media/31879907eebdbcf596766e1f87506189.png)

Turn on the Bluetooth on mobile phone → click the Bluetooth button in
the upper right corner of this APP →search and pair them.

(Note: we need to turn on the location permission when we pair
Bluetooth.)

![](/media/a368e3381590429b53bc7a17fbff6464.png)

Select TANK ROBOT and the following page appears:

![](/media/2a9b5222a3dd4ec16e2f479d00b82b24.png)

The usage of this App is almost the same for Apple system and Android
system. And here we intend to take Android system as an example to
explain how to use it properly.

**Download instructions for Android System**

Search KeyesRobot in Google Play or click following link:

https:/play.google.com/store/apps/details?id=com.keyestudio.keyestudio

![](/media/ec232996a18b4cad2a22379fc795f0ee.png)

Click Sign in to download the APP

![](/media/2ecba5bc20bf85129a394d2b9b99321a.png)

The following icon implies a successful installation.

![](/media/1e01c31ab01988cbcd9bd52554d8bc3b.png)

Click the icon to enter the APP and choose TANK ROBOT;

Enable "location and Bluetooth" permission, then connect and pair
Bluetooth;

Scan for Bluetooth devices and the name of Bluetooth BLE 4.0 is HMSoft
which does not have a pairing password.

![](/media/31879907eebdbcf596766e1f87506189.png)

After uploading the test code successfully, powering it up and
connecting it with Bluetooth, the LED on the Bluetooth module flashed;

Click icon ![](/media/a368e3381590429b53bc7a17fbff6464.png) and search for Bluetooth as shown
below.

![](/media/a32f0b37bea6bc13a2f785c6aeb35d22.png)

Click connect and the pairing is done and the LED remains on.

![](/media/afdedea4a9a7235766e67c22744d725f.png)

Connect the Bluetooth module and open the serial monitor to set the baud
rate to 9600;

Press the button of the Bluetooth APP, and the corresponding characters
are displayed in the serial monitor as shown in the picture below:

![](/media/6886bcc40850b08182b6970bdafd1ed0.png)

**(3)Test Code 1**

Now let’s move to test code.

(Note:When uploading the code, the Bluetooth module must be unplugged,
and the Bluetooth can be reconnected after the uploading process.
Otherwise the code may not be burned, and we also need to turn on the
GPS when it is connected to the Bluetooth.)

（3）蓝牙测试代码

/\*

keyestudio Mini Tank Robot v3.0

lesson 20.1

bluetooth test

http:/www.keyestudio.com

\*/

char ble\_val; /Character variable(used to store the value received by
Bluetooth)

void setup() 

void loop() 

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

First remove the Bluetooth module and upload the test code;

Then reconnect the Bluetooth module and open the serial monitor to set
the baud rate to 9600;

Press the button of the Bluetooth APP, and the corresponding characters
are displayed in the serial monitor as shown in the picture below:

below.

![](/media/805f8ee5c8998a5d6cb8bcef9da09186.png)

The following table illustrates the functions of corresponding keys:

<table>
<tbody>
<tr class="odd">
<td>Keys</td>
<td>Functions</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/1118dccd714c7988a51cf2dde58627e3.png" style="width:1.41319in;height:0.34306in" /></td>
<td>Pair and connect HM-10 Bluetooth module;click again to disconnect</td>
<td></td>
</tr>
<tr class="odd">
<td><img src="/media/b23e65f788685576275cc16bf0b679cc.png" style="width:1.22292in;height:0.32986in" /></td>
<td>select the robot to operate</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/8d910d19cec4d03b5d9cb787425d8d7c.png" style="width:1.14583in;height:0.50069in" /></td>
<td>to control the movements of the robot by buttons</td>
<td></td>
</tr>
<tr class="odd">
<td><img src="/media/9c0c7230244e08fc5afa28b18e8b4241.png" style="width:1.15556in;height:0.475in" /></td>
<td>To control the movements of the robot by joystick</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/3ab61154b4ae730a3757f40171846825.png" style="width:1.1375in;height:0.49097in" /></td>
<td>To control the movements of the robot by gravity</td>
<td></td>
</tr>
<tr class="odd">
<td><img src="/media/fe15b0e4a7e705027cb042d0fd2398ea.png" style="width:1.13611in;height:0.52708in" /></td>
<td>Send “F”when pressed and “S”when released</td>
<td>The car moves forward when it is pressed and stops when released</td>
</tr>
<tr class="even">
<td><img src="/media/b1765938932b8633bd5a96af0293ef24.png" style="width:0.57847in;height:1.02361in" /></td>
<td>Send “L”when pressed and “S”when released</td>
<td>The car turns left when it is pressed tight and stops when released</td>
</tr>
<tr class="odd">
<td><img src="/media/67f26bd7d2076922470e8805711f2ef9.png" style="width:0.54444in;height:1.05139in" /></td>
<td>Send “R”when pressed and “S”when released</td>
<td>The car turns right when it is pressed tight and stops when released</td>
</tr>
<tr class="even">
<td><img src="/media/77615a8ca984e538d58e02ac90bc5382.png" style="width:1.10903in;height:0.5875in" /></td>
<td>Send “B”when pressed and “S”when released</td>
<td>The car turns back when it is pressed tight and stops when released</td>
</tr>
<tr class="odd">
<td><img src="/media/f58421773a56c911b09c150d08b0fd67.png" style="width:1.7625in;height:0.16806in" /></td>
<td>Send “u”+digit+“#”when dragged</td>
<td>Drag to change the speed of the left motor</td>
</tr>
<tr class="even">
<td><img src="/media/a05432839507dd25b7dc7eb1bb9a02bb.png" style="width:1.75833in;height:0.13542in" /></td>
<td>Send “v”+digit+“#”when dragged</td>
<td>Drag to change the speed of the right motor</td>
</tr>
<tr class="odd">
<td><img src="/media/5dd730ab4d2299210dc2399303b94e33.png" style="width:1.27708in;height:0.44653in" /></td>
<td>Select to enter Function page</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/a352ca9be952db2838540657b9a70f8c.png" style="width:0.65139in;height:0.66944in" /></td>
<td>Send “G”when pressed and “S”when pressed again</td>
<td>Enter obstacle avoidance mode when pressed and exit when pressed again</td>
</tr>
<tr class="odd">
<td><img src="/media/64da14a6ca501aa97f8eb8895e9f6b1c.png" style="width:0.65764in;height:0.70139in" /></td>
<td>Send “h”when pressed and “S”when pressed again</td>
<td>Enter following mode when pressed and exit when pressed again</td>
</tr>
<tr class="even">
<td><img src="/media/e4f3b211f8c8b06d1eab9dd2281dff74.png" style="width:0.65139in;height:0.72986in" /></td>
<td>Send “e”when pressed and “S”when pressed again</td>
<td>Enter line-tracking mode when pressed and exit when pressed again</td>
</tr>
<tr class="odd">
<td><img src="/media/3d662f37603a8f0c1c34ab2b9ff28c63.png" style="width:0.65069in;height:0.64306in" /></td>
<td>Send “f”when pressed and “S”when pressed again</td>
<td>Enter move-in-confined-space mode when pressed and exit when pressed again</td>
</tr>
<tr class="even">
<td><img src="/media/48ab7c8c488c61abc162dbda0fc75f27.png" style="width:0.66806in;height:0.64028in" /></td>
<td>Send “i”when pressed and “S”when pressed again</td>
<td>Enter light following mode when pressed and exit when pressed again</td>
</tr>
<tr class="odd">
<td><img src="/media/4250a152c647cc59f72bf51328943371.png" style="width:0.66806in;height:0.76319in" /></td>
<td>Send “j”when pressed and “S”when pressed again</td>
<td>Enter fire extinguishing mode when pressed and exit when pressed again</td>
</tr>
<tr class="even">
<td><img src="/media/cc420ba3d148bd6b720dd44df9a82768.png" style="width:0.95625in;height:0.40833in" /></td>
<td>Select to enter facial expression display mode</td>
<td></td>
</tr>
<tr class="odd">
<td><img src="/media/17261f134c25702ae129624860ab8fe1.png" style="width:0.64861in;height:0.73819in" /></td>
<td>Send “k”when pressed and “z”when pressed again</td>
<td>Show smiling pattern when clicked and clear expression when clicked again</td>
</tr>
<tr class="even">
<td><img src="/media/a8bff045e822a06a24bfd7599c9f142a.png" style="width:0.63125in;height:0.7875in" /></td>
<td>Send “l”when pressed and “z”when pressed again</td>
<td>Show disgusting pattern when clicked and clear expression when clicked again</td>
</tr>
<tr class="odd">
<td><img src="/media/8729f3ac4adf446b388221ae2e4cf71f.png" style="width:0.63333in;height:0.77153in" /></td>
<td>Send “m”when pressed and “z”when pressed again</td>
<td>Show happy face when clicked and clear expression when clicked again</td>
</tr>
<tr class="even">
<td><img src="/media/63d935cd1958863f862374ded9b87d6b.png" style="width:0.62639in;height:0.71944in" /></td>
<td>Send “n”when pressed and “z”when pressed again</td>
<td>Show sad pattern when clicked and clear expression when clicked again</td>
</tr>
<tr class="odd">
<td><img src="/media/5e84087020b919a85495831b231efa5a.png" style="width:0.63194in;height:0.71597in" /></td>
<td>Send “o”when pressed and “z”when pressed again</td>
<td>Show disparaging pattern when clicked and clear expression when clicked again</td>
</tr>
<tr class="even">
<td><img src="/media/3b7d99862c2d9a5e7337645b4548091e.png" style="width:0.66111in;height:0.77639in" /></td>
<td>Send “p”when pressed and “z”when pressed again</td>
<td>Show heart-shaped pattern when clicked and clear expression when clicked again</td>
</tr>
<tr class="odd">
<td><img src="/media/41bf8b28dea6061cea89b640f5646403.png" style="width:1.14375in;height:0.3875in" /></td>
<td>Choose to enter the custom function interface; there are six keys 1,2,3,4,5,6; with these keys, you can expand some functions by yourself</td>
<td></td>
</tr>
<tr class="even">
<td><img src="/media/06b8f32aae6c9914ef227d6966ea537f.png" style="width:1.4in;height:0.24931in" /></td>
<td>Click to send “w”</td>
<td>Click to display the analog value detected by the photoresistor on the left</td>
</tr>
<tr class="odd">
<td><img src="/media/a89df3c223e6a7d4eac29d4fe2ee14af.png" style="width:1.42153in;height:0.27708in" /></td>
<td>Click to send“y”</td>
<td>Click to display the analog value detected by the photoresistor on the right</td>
</tr>
<tr class="even">
<td><img src="/media/a76df707b84409e57a1167889c3510d9.png" style="width:1.40764in;height:0.26389in" /></td>
<td>Click to send“x”</td>
<td>Click to show the distance detected by ultrasonic sensor (unit: cm)</td>
</tr>
<tr class="odd">
<td><img src="/media/704e5c6a72d89ee8f78d79ff3cd9537c.png" style="width:1.12292in;height:0.36736in" /></td>
<td><p>Click to send“c”</p>
<p>Click again to send“d”</p></td>
<td>Press to turn on the fan and press again to turn off it</td>
</tr>
</tbody>
</table>

**(4)Flow chart**

**(5)Connection Diagram:**

![](/media/25be906589f42d40c20ad1e8df04bdf7.png)

The GND, VCC, SDA, and SCL of the 8x16 LED dot matrix are respectively
connected to-(GND), + (VCC), SDA, SCL of the expansion board;

The Bluetooth module is directly plugged into the expansion board.
Please pay attention to the direction of the pin. The STATE and BRK pins
of the Bluetooth module do not need to be connected.

**(6)Test Code 2**

(Note:When uploading the code, the Bluetooth module must be unplugged,
and the Bluetooth can be reconnected after the uploading process.
Otherwise the code may not be burned.)

（5）智能车测试代码：

/\*

keyestudio Mini Tank Robot V3

lesson 20.2

bluetooth tank

http:/www.keyestudio.com

\*/

/Array, used to save data of images, can be calculated by yourself or
gotten from modulus tool

unsigned char start01\[\] = ;

unsigned char front\[\] = ;

unsigned char back\[\] = ;

unsigned char left\[\] = ;

unsigned char right\[\] = ;

unsigned char STOP01\[\] = ;

unsigned char clear\[\] = ;

\#define SCL\_Pin A5 /Set the clock pin as A5

\#define SDA\_Pin A4 /Set the data pin as A4

\#define ML\_Ctrl 4 /Define the direction control pin of the left motor

\#define ML\_PWM 5 /Define the PWM control pin of the left motor

\#define MR\_Ctrl 2 /Define the direction control pin of the right
motor

\#define MR\_PWM 9 /Define the PWM control pin of the right motor

char ble\_val; /Used to store the value obtained by Bluetooth

void setup() 

void loop() 

switch (ble\_val)



}

/\*\*\*\*\*\*\*\*\*\*The function controls the rotation of the
servo\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Car\_front() 

void Car\_back() 

void Car\_left() 

void Car\_right() 

void Car\_Stop() 

/This function is used for dot matrix display

void matrix\_display(unsigned char matrix\_value\[\])



IIC\_end(); /End the transmission of pattern data

IIC\_start();

IIC\_send(0x8A); /Display control, choose 4/16 pulse width

IIC\_end();

}

/Conditions for the start of data transmission

void IIC\_start()



/The signal of the end of data transmission

void IIC\_end()



/Transmit data

void IIC\_send(unsigned char send\_data)

 else 

delayMicroseconds(3);

digitalWrite(SCL\_Pin, HIGH); /Pull up the clock pin SCL\_Pin to end
the transmission of data

delayMicroseconds(3);

digitalWrite(SCL\_Pin, LOW); /Pull down the clock pin SCL\_Pin to
change signals of SDA

}

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

**(7)Test Results:**

After uploading the test code successfully, dialing the DIP switch to
the right end, powering it on, and pairing the APP with Bluetooth, the
smart car can be controlled to move by the APP.6）测试结果

**Project 21: Speed-Controlled-by-Bluetooth Tank**

![](/media/bc6f346d0044194eff10034bf6de1032.jpeg)

**(1)Description:**

In the previous project, we have learned how to control a smart tank
with Bluetooth. The PWM value of the motor we used before is 200 (speed
is 200). In this lesson, we will use Bluetooth to adjust the speed of
the smart car, but the fixed speed of 200 cannot be changed. We should
define a variable speeds to store the speed value. Through the previous
study, we have known that the range of this value is from 0 to 255.

**(2)Flow chart**

（2）项目流程

**(3)Connection Diagram:**

（3）智能车接线图

![](/media/25be906589f42d40c20ad1e8df04bdf7.png)

The GND, VCC, SDA, and SCL of the 8x16 LED dot matrix are respectively
connected to-(GND), + (VCC), SDA, SCL of the expansion board;

The Bluetooth module is directly plugged into the expansion board.
Please pay attention to the direction of the pin. The STATE and BRK pins
of the Bluetooth module do not need to be connected.

**(4)Test Code**

(Note:When uploading the code, the Bluetooth module must be unplugged,
and the Bluetooth can be reconnected after the uploading process.
Otherwise the code may not be burned.)

4）智能车测试代码：

/\*

keyestudio Mini Tank Robot V3

lesson 21

bluetooth control speed tank

http:/www.keyestudio.com

\*/

/Array, used to save data of images, can be calculated by yourself or
gotten from modulus tool

unsigned char start01\[\] = ;

unsigned char front\[\] = ;

unsigned char back\[\] = ;

unsigned char left\[\] = ;

unsigned char right\[\] = ;

unsigned char STOP01\[\] = ;

unsigned char clear\[\] = ;

unsigned char speed\_a\[\] = ;

unsigned char speed\_d\[\] = ;

\#define SCL\_Pin A5 /set the pin of clock to A5

\#define SDA\_Pin A4 /A4 set data pin to A4

\#define ML\_Ctrl 4 /define the direction control pin of the left motor

\#define ML\_PWM 5 /define the PWM control pins of the left motor

\#define MR\_Ctrl 2 /define the direction control pin of the right
motor

\#define MR\_PWM 9 /define the PWM control pin of the right motor

char ble\_val; /used to save the value from Bluetooth

byte speeds = 200;;/the initial speed is 200

void setup() 

void loop() 

switch (ble\_val) 

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*motor runs\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Car\_front() 

void Car\_back() 

void Car\_left() 

void Car\_right() 

void Car\_Stop() 

void Car\_T\_left() 

void Car\_T\_right() 

void speeds\_a() 

ble\_val = Serial.read();

if (ble\_val == 'S')break; /receive ‘S’ to stop speeding up

}

}

void speeds\_d() 

ble\_val = Serial.read();

if (ble\_val == 'S')break; /receive ‘S’ and stop accelaration

}

}

/this function is used for the display of dot matrix

void matrix\_display(unsigned char matrix\_value\[\])



IIC\_end(); /end the data transmission of pictures

IIC\_start();

IIC\_send(0x8A); /show control and select pulse width 4/16

IIC\_end();

}

/the condition that data starts transmitting

void IIC\_start()



/the sign that transmission of data ends

void IIC\_end()



/transmit data

void IIC\_send(unsigned char send\_data)

 else 

delayMicroseconds(3);

digitalWrite(SCL\_Pin, HIGH); /pull up the clock pin SCL\_Pin to end
the transmission of data

delayMicroseconds(3);

digitalWrite(SCL\_Pin, LOW); /pull down the clock pin SCL\_Pin to
change signals of SDA

}

}

**(5)Test Results:**

After uploading the test code successfully, dialing the DIP switch to
the right end, powering it on, and pairing the APP with Bluetooth, the
smart car can be controlled to move by the APP. And the speed of the car
can be regulated by pulling the speed dials of the left and right
motors.

(You can refer to function table in project 20 for help)测试结果

**Project 22: Multifunctional Tank**

## ![](/media/55638241b5cef959d3f01494c82c2ea3.jpeg)

**(1)Description:**

The smart car has performed a single function in every previous project.
Can it display multiply functions at a time ? Positive. In this last big
project, we intend to use a complete code to control the smart car to
show off all functions mentioned in previous projects. We use the keys
on the Bluetooth APP to automatically switch various functions, quite
simple and convenient.

**(2)Flow chart**

**(3)Connection Diagram:**

接线图

![](/media/0a9d69986c4f47a6c681541348d565a0.png)

1.Please carefully check the wiring.When we want to show the fire
extinguishing function of this car, we need to detach the ultrasonic
sensor, servo, and photosensitive from it, and replace them with the fan
module and flame sensor;

2.The GND, VCC, SDA, and SCL of the 1.8x16 LED dot matrix are
respectively connected to-(GND), + (VCC), SDA, SCL of the expansion
board;

3.The VCC pin of the ultrasonic sensor (fan module) is connected to
5v(V), Trig pin to digital 12(S), Echo pin to digital 13(S), and Gnd pin
to Gnd(G);

4.The servo is connected to G, V, and 10. The brown wire of the servo is
connected to Gnd (G), the red wire is connected to 5v (V), and the
orange wire is connected to 10;

5.The RXD, TXD, GND, and VCC of the Bluetooth module are respectively
connected to TX, RX,-(GND), + (VCC), and the STATE and BRK pins of the
Bluetooth module do not need to be connected;

6.The "-", "+" and S pins of the infrared receiving sensor module are
respectively connected to the sensor expansion board G (GND), V (VCC),
A2 with wires;

7.  The pins "-" "+" and S of the left photoresistor (flame sensor)
    module are respectively connected to the G (GND), V (VCC), A0 of the
    expansion board and for the right photoresistor (flame sensor)
    module they are connected to G (GND), V (VCC), A1.

8.  Line-tracking sensor is connected to digital pins 6,7 and 8.
    
    **(4)Test Code**
    
    （4）测试代码：

/\*

keyestudio Mini Tank Robot V3

lesson 22

multiple functions

http:/www.keyestudio.com

\*/

\#include \<IRremote.h\>

IRrecv irrecv(A2); /

decode\_results results;

long ir\_rec; /used to save the IR value

/Array, used to save data of images, can be calculated by yourself or
gotten from modulus tool

unsigned char start01\[\] = ;

unsigned char STOP01\[\] = ;

unsigned char front\[\] = ;

unsigned char back\[\] = ;

unsigned char left\[\] = ;

unsigned char right\[\] = ;

unsigned char Smile\[\] = ;

unsigned char Disgust\[\] = ;

unsigned char Happy\[\] = ;

unsigned char Squint\[\] = ;

unsigned char Despise\[\] = ;

unsigned char Heart\[\] = ;

unsigned char clear\[\] = ;

\#define SCL\_Pin A5 /set the pin of clock to A5

\#define SDA\_Pin A4 /set the data pin to A4

\#define ML\_Ctrl 4 /define the direction control pin of the left motor
as 4

\#define ML\_PWM 5 /define the PWM control pin of the left motor as 5

\#define MR\_Ctrl 2 /define the direction control pin of the right
sensor as 2

\#define MR\_PWM 9 /define the PWM control pin of the right motor as 9

char ble\_val; /used to save the Bluetooth value

byte speeds\_L = 200; /the initial speed of the left motor is 200

byte speeds\_R = 200; / the initial speed of the right motor is 200

String speeds\_l, speeds\_r; /receive PWM characters and convert them
into PWM value

/\#define light\_L\_Pin A0 /define the pin of the left photoresistor

/\#define light\_R\_Pin A1 /define the pin of the right photoresistor

int left\_light;

int right\_light;

int flame\_L = A0; /define the analog port of the left flame sensor to
A0

int flame\_R = A1; /define the analog port of the right flame sensor to
A1

/wire up the line tracking sensor

\#define L\_pin 6 /left

\#define M\_pin 7 /middle

\#define R\_pin 8 /right

int L\_val, M\_val, R\_val, flame\_valL, flame\_valR;

/the pin of 130 motor

int INA = 12;

int INB = 13;

/\#define Trig 12

/\#define Echo 13

float distance;/Store the distance values detected by ultrasonic for
following

/Store the distance values detected by ultrasonic for obstacle
avoidance

int a;

int a1;

int a2;

\#define servoPin 10 /servo Pin

bool flag; / flag invariable used to enter and exit a mode

void setup() 

void loop() 

}

/the following signals are used to print out

/\*if(ble\_val == 'x')else if(ble\_val == 'w')else if(ble\_val == 'y')\*/

if (irrecv.decode(\&results)) 

irrecv.resume();

}

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*obstacle
avoidance\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

/\*void Avoid()

 else 

}

else 

/ receive the Bluetooth value to exit the loop

if (Serial.available())



}

}

}\*/

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*line
tracking\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

/\*void Follow() 

else if (distance \> 10 && distance \< 20) /10＜ distance \< 20， stop



else if (distance \<= 10) /distance≤ 10， go back



else /or else, stop



if (Serial.available())



}

}

}\*/

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*light
following\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

/\*void Light\_following() 

else if (left\_light \> 650 && right\_light \<= 650) /turn left



else if (left\_light \<= 650 && right\_light \> 650) /turn right



else /or else, stop



if (Serial.available())



}

}

}\*/

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*put out
fire\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Fire()  else 

else if (L\_val == 0 && R\_val == 1) 

else 

}

else 

else if (L\_val == 0 && R\_val == 1) 

else 

}

}

if (Serial.available())



}

}

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*line
tracking\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Tracking() 

else if (L\_val == 0 && R\_val == 1) 

else 

}

else 

else if (L\_val == 0 && R\_val == 1) 

else 

}

if (Serial.available())



}

}

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*confinement\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Confinement() 

else 

if (Serial.available())



}

}

}

/he function to control the ultrasonic

/\*float checkdistance() \*/

/the function to control servo

void procedure(int myangle) 

}

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*fan
rotates\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void fan\_begin() 

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*fan stops
rotating\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void fan\_stop() 

/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*dot
matrix\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

/this function is used for the display of dot matrix

void matrix\_display(unsigned char matrix\_value\[\])



IIC\_end(); /end the data transmission of pictures

IIC\_start();

IIC\_send(0x8A); /show control and select pulse width 4/16

IIC\_end();

}

/the condition that data starts transmitting

void IIC\_start()



/transmit data

void IIC\_send(unsigned char send\_data)

 else 

delayMicroseconds(3);

digitalWrite(SCL\_Pin, HIGH); /pull up the clock pin SCL\_Pin to end
the transmission of data

delayMicroseconds(3);

digitalWrite(SCL\_Pin, LOW); /pull down the clock pin SCL\_Pin to
change signals of SDA

}

}

/the sign that transmission of data ends

void IIC\_end()



/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*motor runs\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/

void Car\_front() 

void Car\_back() 

void Car\_left() 

void Car\_right() 

void Car\_Stop() 

**(5)Test Results:**

测()试结果

(Note: before uploading the test code, you need to remove the Bluetooth
module. Otherwise the code will fail to upload. When the code uploading
process is done, open the GPS on your phone, and then reconnect the
Bluetooth module.)

After uploading the test code successfully, powering it on, and pairing
the APP with Bluetooth, the smart car can be controlled to perform
various functions by the APP.

We can realize the corresponding functions by pressing the corresponding
keys to select various modes, and finally end the operation of the smart
car with the key Stop. The above wiring diagram does not have a fan
module and a flame sensor module. When we show the fire extinguishing
function of the car, we need to replace the servo, the ultrasonic sensor
and the photoresistor with the fan module and flame module. Of course,
at that time we cannot enter the straight-line following, ultrasonic
obstacle avoidance and light-seeking modes. However, we use pins to fix
sensors and modules, which makes the detachment and assembly very
simple. No need worry about it. But we need to block the unused code for
some modules using the same IO port. The fan module and the flame sensor
module in the above code have been blocked.

All the projects have been completed. Hope you’d obtain some fresh
knowledge. If you encounter any problem involves this kit, please feel
free to contact our customer service professionals who will help you
timely.

And we strongly recommend you to have a go on the following products
rolled out by Keyestudio. Thank you for your attention.

|                                     |                                                                        |                                              |
| ----------------------------------- | ---------------------------------------------------------------------- | -------------------------------------------- |
| ![](/media/ac1b7dc172c3f335b5370eb3b9b8e173.jpeg) |
| ![](/media/a523f8f659b88422e6751233dfcf698e.jpeg)            |

**9**

**9.Resources**

[https:/fs.keyestudio.com/KS0](https:/fs.keyestudio.com/KS0426)526

#
